(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{235:function(e,t,n){"use strict";(function(e){var t=u(n(99)),o=(u(n(299)),u(n(282)),u(n(283)),u(n(285)),u(n(286)),u(n(387)),u(n(18))),i=u(n(0)),a=u(n(1)),r=u(n(28)),s=d(n(6)),l=u(n(24)),c=d(n(331));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e){return e&&e.__esModule?e:{default:e}}n(389),n(390),n(391),n(392),n(393),n(394),n(396),n(279),n(298),n(63),n(332),e(document).ready(function(){var n={_id:(0,l.default)(window.location).segment(-1)},d=null,u=null,h=null,p=null,f=null,g=null,m=null,v=null,_=null,b=null,w=null,y=null,x=null,k=null,A=null,C=null,S=null,T=null,P=null,I=null,j=null,E=null,O=null,M=!1,$=!1,D=!1,R=!1,W=!1,z=!1,L=null,H=null;e("#timeseries-model").layout({applyDefaultStyles:!1,north:{size:28,resizable:!1,resizeWhileDragging:!1},west:{size:e("#timeseries-model").width()/2,resizeWhileDragging:!1,onresize:function(){e("#dendrogram-viewer").dendrogram("resize_canvas")}},center:{resizeWhileDragging:!1,onresize:function(){e("#waveform-viewer").waveformplot("resize_canvas")}},east:{size:130,resizeWhileDragging:!1,onresize:function(){e("#legend").legend("option",{width:e("#legend-pane").width(),height:e("#legend-pane").height()})}},south:{size:e("#timeseries-model").height()/3,resizeWhileDragging:!1,onresize:function(){e("#table").table("resize_canvas")}}});function B(e){return Array.isArray(e)?e:JSON.parse(e)}function U(e){return"object"===(void 0===e?"undefined":(0,t.default)(e))?e:JSON.parse(e)}!function t(){e.ajax({type:"GET",url:o.default+"models/"+n._id,success:function(i){if("closed"===(n=i).state&&null===n.result&&(window.alert("model failed to complete possibly the connection was terminated to the hpc client try pulling data"),N(),setTimeout(t,15e3)),"finished"===n.state&&a.default.put_model({mid:n._id,state:"closed",success:function(){window.location.reload(!0)},error:function(){window.location.reload(!0)}}),"closed"===n.state&&"succeeded"===n.result){if(d=r.default.create(n.project,n._id),n["artifact:cluster-bin-count"],n["artifact:cluster-bin-type"],n["artifact:cluster-type"],n.hasOwnProperty("artifact:image-columns")?H=n["artifact:image-columns"]:(console.log("This model has no artifact:image-columns"),a.default.get_model_command({mid:n._id,type:"timeseries",command:"media-columns",success:function(e){a.default.put_model_parameter({mid:n._id,aid:"image-columns",value:e,input:!0,success:function(){H=e}})},error:function(e){console.log("error getting model command")}})),e(".slycat-job-checker").remove(),"failed"==n.result)return;!function(){function t(){null!==v&&null!==h&&d.getState(function(e){m=void 0!==(u=e)["cluster-index"]?u["cluster-index"]:0,T=[],"simulation-selection"in u?T=u["simulation-selection"]:"cluster-index"in u&&u["cluster-index"]+"-selected-row-simulations"in u&&(T=u[u["cluster-index"]+"-selected-row-simulations"]),k=[],A=[],C=[],S=[];for(var t=0;t<h.length;t++)k[t]=void 0!==u[t+"-column-index"]?u[t+"-column-index"]:v["column-count"]-1,A[t]=v["column-types"][k[t]],C[t]=v["column-min"][k[t]],S[t]=v["column-max"][k[t]];y=[];for(var t=0;t<v["column-count"];t++)void 0!=H&&-1==H.indexOf(t)&&y.push(t);y.unshift(y.pop()),L=[];for(var t=0;t<h.length;t++)L[t]=void 0!==u[t+"-selected-waveform-indexes"]?u[t+"-selected-waveform-indexes"]:null;w=void 0!==u.colormap?u.colormap:"night",P=void 0!=u["sort-variable"]?u["sort-variable"]:void 0,I=void 0!=u["sort-order"]?u["sort-order"]:void 0,j=[],E=[],O=[];for(var t=0;t<h.length;t++)j[t]=u[t+"-collapsed-nodes"],E[t]=u[t+"-expanded-nodes"],O[t]=u[t+"-selected-nodes"];q(),G()})}e(".load-status").text("Loading data."),e.ajax({url:o.default+"models/"+n._id+"/files/clusters",contentType:"application/json",success:function(e){h=e,p=new Array(h.length),f=new Array(h.length),g=new Array(h.length),q(),t()},error:F}),e.ajax({url:o.default+"models/"+n._id+"/tables/inputs/arrays/0/metadata?index=Index",contentType:"application/json",success:function(e){v=e,q(),G(),t()},error:F})}()}else N(),setTimeout(t,15e3)},error:function(e,t,n){window.alert("Error retrieving model: "+n)}})}();var N=function(){var t=e("#timeseries-model").children()[0],o=e(t);o.detach(),e(e("#timeseries-model").children()).remove(),e("#timeseries-model").append(o),i.default.dataFor(e(".slycat-job-checker")[0]).set_jid(n["artifact:jid"])};function F(){e(".load-status").css("display","none"),s.dialog({title:"Load Error",message:"Oops, there was a problem retrieving data from the model. This likely means that there was a problem during computation."})}function G(){u&&v&&null!=k&&null!==m&&V({column:k[m],callback:function(e){q()}})}function V(t){var i=v["column-count"]-1,a=v["column-min"][i],r=v["column-max"][i]+1;e.ajax({url:o.default+"models/"+n._id+"/tables/inputs/arrays/0/chunk?rows="+a+"-"+r+"&columns="+t.column+"&index=Index&sort="+i+":ascending",async:!0,callback:t.callback,success:function(e){_=e.data[0],this.callback(e.data[0])},error:function(e,t,n){window.alert("Error getting color coding values from table-chunker worker: "+n)}})}function q(){if(u&&B(h)&&null!==m&&void 0===f[m]&&void 0===g[m]&&(f[m]=null,g[m]=null,c.get_model_arrayset({api_root:o.default+"",mid:n._id,aid:"preview-"+B(h)[m],success:function(e,t){f[m]=e,g[m]=t,q()},error:F})),u&&B(h)&&void 0===p[m]&&(p[m]=null,e.ajax({url:o.default+"models/"+n._id+"/files/cluster-"+B(h)[m],contentType:"application/json",success:function(e){p[m]=e,q()},error:F})),!M&&u&&B(h)&&null!==m&&null!=T&&v&&null!==y&&null!==L&&null!==k&&null!==m){M=!0,e("#cluster-pane .load-status").css("display","none");var t={mid:n._id,model_name:window.model_name,aid:"inputs",metadata:v,highlight:T,clusters:B(h),cluster:m,color_variables:y,"color-variable":k[m],selection:L[parseInt(m,10)],image_columns:H};e("#controls").controls(t),e("#controls").bind("cluster-changed",function(e,t){J(t)}),e("#controls").bind("color-selection-changed",function(t,n){K(n=parseInt(n)),e("#table").table("option","variable-selection",[k[m]])})}if(!$&&u&&null!==w&&($=!0,e("#color-switcher").colorswitcher({colormap:w}),X(q),e("#color-switcher").bind("colormap-changed",function(t,i){!function(t){w=t,e("#legend-pane").css("background",e("#color-switcher").colorswitcher("get_background",w).toString()),e("#legend").legend("option",{gradient:e("#color-switcher").colorswitcher("get_gradient_data",w)}),e("#dendrogram-sparkline-backdrop").css({"background-color":e("#color-switcher").colorswitcher("get_background",w).toString()}),e("#waveform-pane").css({"background-color":e("#color-switcher").colorswitcher("get_background",w).toString()}),e("#waveform-viewer rect.selectionMask").css({fill:e("#color-switcher").colorswitcher("get_background",w).toString(),"fill-opacity":e("#color-switcher").colorswitcher("get_opacity",w)}),Z(),e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/colormap/"+w}),d.updateState({colormap:w})}(i)})),!z&&u&&v&&null!==m&&null!==w&&null!==k&&null!==A&&null!==b&&(z=!0,e("#legend-pane .load-status").css("display","none"),e("#legend-pane").css("background",e("#color-switcher").colorswitcher("get_background",w).toString()),e("#legend").legend({width:e("#legend-pane").width(),height:e("#legend-pane").height(),gradient:e("#color-switcher").colorswitcher("get_gradient_data",w),label:v["column-names"][k[m]],min:v["column-min"][k[m]],max:v["column-max"][k[m]],v_type:A[m],uniqueValues:x})),!R&&u&&null!==m&&null!==f&&void 0!==f[m]&&null!==f[m]&&null!==_&&null!==b&&null!==v&&null!==T&&null!==L){R=!0,e("#waveform-pane .load-status").css("display","none"),e("#waveform-pane").css({"background-color":e("#color-switcher").colorswitcher("get_background",w).toString()}),e("#waveform-viewer rect.selectionMask").css({fill:e("#color-switcher").colorswitcher("get_background",w).toString(),"fill-opacity":e("#color-switcher").colorswitcher("get_opacity",w)});var i={mid:n._id,waveforms:f[m],color_scale:b,color_array:_,highlight:T,selection:L[parseInt(m,10)]};e("#waveform-viewer").waveformplot(i),e("#waveform-viewer").bind("waveform-selection-changed",function(t,n){Y(n),e("#dendrogram-viewer").dendrogram("option","highlight",n),e("#controls").controls("option","highlight",n),e("#table").table("option","row-selection",n)})}if(!W&&u&&v&&null!==m&&null!==T&&null!==w&&null!==b&&null!==k&&null!==A&&null!==C&&null!==S&&null!==P&&null!==I&&null!==H){W=!0,e("#table-pane .load-status").css("display","none");var a={api_root:o.default,mid:n._id,aid:"inputs",metadata:v,colorscale:b,colormap:w,"variable-selection":[k[m]],"row-selection":T,"sort-variable":P,"sort-order":I,image_columns:H};e("#table").table(a),e("#table").bind("row-selection-changed",function(t,n){Y(n),e("#controls").controls("option","highlight",n),e("#waveform-viewer").waveformplot("option","highlight",n),e("#dendrogram-viewer").dendrogram("option","highlight",n)}),e("#table").bind("variable-sort-changed",function(t,i,a){!function(t,i){P=t,I=i,e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/sort-order/"+t+"/"+i}),d.updateState({"sort-variable":P,"sort-order":I})}(i,a),e("#dendrogram-viewer").dendrogram("option","dendrogram_sort_order",null==i&&null==a)}),e("#table").bind("variable-selection-changed",function(t,n){K(n.variable[0]),e("#controls").controls("option","color-variable",k[m])})}if(!D&&u&&B(h)&&null!==m&&void 0!==p[m]&&null!==p[m]&&null!==_&&null!==b&&null!==T&&null!==w&&null!==C&&null!==S&&null!==P){D=!0,e("#dendrogram-pane .load-status").css("display","none"),e("#dendrogram-sparkline-backdrop").css({"background-color":e("#color-switcher").colorswitcher("get_background",w).toString()});var r=Q(m);r.api_root=o.default,r.mid=n._id,r.clusters=B(h),r.cluster_data=U(p[m]),r.color_scale=b,r.color_array=_,void 0!=P&&(r.dendrogram_sort_order=!1),e("#dendrogram-viewer").bind("node-selection-changed",function(t,i){!function(t){if(L[parseInt(m,10)]=function(t){var n=[],o=null;return e.each(t,function(e,t){null!=(o=t["waveform-index"])&&n.push(o)}),n}(t.selection),O[m]=function(e){for(var t=[],n=null,o=0;o<e.length;o++)null!=(n=e[o]["node-index"])&&t.push(n);return t}(t.selection),1!=t.skip_bookmarking){e("#controls").controls("option","selection",L[parseInt(m,10)]),e("#controls").controls("option","highlight",T),e("#waveform-viewer").waveformplot("option","selection",L[parseInt(m,10)]),e("#waveform-viewer").waveformplot("option","highlight",T);var i={};i[m+"-selected-nodes"]=O[m],i[m+"-selected-waveform-indexes"]=L[parseInt(m,10)],d.updateState(i)}e("#table").table("option","row-selection-silent",T),e("#table").table("option","selection",t.selection),null!=t.node&&null!=t.node["node-index"]&&e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/node/"+t.node["node-index"]})}(i)}),e("#dendrogram-viewer").dendrogram(r),e("#dendrogram-viewer").bind("expanded-collapsed-nodes-changed",function(e,t){!function(e){j[m]=e.collapsed,E[m]=e.expanded;var t={};t[m+"-expanded-nodes"]=E[m],t[m+"-collapsed-nodes"]=j[m],d.updateState(t)}(t)}),e("#dendrogram-viewer").bind("node-toggled",function(t,i){!function(t){e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/toggle/node/"+t["node-index"]})}(i)}),e("#dendrogram-viewer").bind("waveform-selection-changed",function(t,n){Y(n),e("#controls").controls("option","highlight",n),e("#waveform-viewer").waveformplot("option","highlight",n),e("#table").table("option","row-selection",n)}),e("#dendrogram-viewer").bind("sort-by-dendrogram-order",function(t){e("#table").table("option","sort-variable",null)}),e("#dendrogram-viewer").bind("cluster-changed",function(e,t){J(t)})}}function J(t){(function(t){if(void 0===p[t]||null===p[t])e.ajax({url:o.default+"models/"+n._id+"/files/cluster-"+B(h)[t],contentType:"application/json",success:function(n){p[t]=n;var o=Q(t);o.cluster_data=U(p[t]),e("#dendrogram-viewer").dendrogram("option",o)},error:F});else{var i=Q(t);i.cluster_data=U(p[t]),e("#dendrogram-viewer").dendrogram("option",i)}})(m=t),function(t){if(void 0===f[t])c.get_model_arrayset({api_root:o.default,mid:n._id,aid:"preview-"+B(h)[t],success:function(n,o){f[t]=n,g[t]=o;var i={waveforms:f[t],selection:L[t],highlight:T};e("#waveform-viewer").waveformplot("option","waveforms",i)},error:F});else{var i={waveforms:f[t],selection:L[t],highlight:T};e("#waveform-viewer").waveformplot("option","waveforms",i)}}(m),e("#table").table("option","variable-selection",[k[m]]),e("#controls").controls("option","color-variable",k[m]),Z(),e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/cluster/"+m}),d.updateState({"cluster-index":m})}function Y(t){T=t,e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/simulation/count/"+T.length});var i={};i["simulation-selection"]=T,d.updateState(i)}function K(t){k[m]=t,A[m]=v["column-types"][k[m]],C[m]=v["column-min"][k[m]],S[m]=v["column-max"][k[m]],Z(),e.ajax({type:"POST",url:o.default+"events/models/"+n._id+"/select/variable/"+k[m]});var i={};i[m+"-column-index"]=k[m],d.updateState(i)}function X(t){"string"!=A[m]?(b=e("#color-switcher").colorswitcher("get_color_scale",void 0,C[m],S[m]),t(b)):e.ajax({type:"GET",url:o.default+"models/"+n._id+"/arraysets/inputs/metadata?unique=0/"+k[m]+"/...",success:function(n){x=n.unique[0].values[0],b=e("#color-switcher").colorswitcher("get_color_scale_ordinal",void 0,x),t(b)},error:function(e){console.log("there was an error. here it is: "+e)}})}function Z(){X(function(t){V({column:k[m],callback:function(n){var o={color_array:n,color_scale:t};e("#waveform-viewer").waveformplot("option","color-options",o),e("#dendrogram-viewer").dendrogram("option","color-options",o),e("#table").table("option","colorscale",t),e("#legend").legend("option",{min:v["column-min"][k[m]],max:v["column-max"][k[m]],label:v["column-names"][k[m]],v_type:A[m],uniqueValues:x})}})})}function Q(e){var t={cluster:e};return t.collapsed_nodes=j[e],t.expanded_nodes=E[e],t.selected_nodes=O[e],t.highlight=T,t}})}).call(this,n(2))},302:function(e,t,n){e.exports={default:n(324),__esModule:!0}},324:function(e,t,n){n(78),n(77),e.exports=n(325)},325:function(e,t,n){var o=n(9),i=n(100);e.exports=n(7).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return o(t.call(e))}},329:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EHhESC1NkMY8AAABaSURBVDjLY2AYkiAtLRSrOCMBTf8JGTxr1mpGFiIcwDhr1mq4K2bNWo2hgIkIQ4RwaSbakFmzVr8jpIaJlIDF5RoWYgOQkiglynAmalg2eAyhSoqlSt4ZPAAAhK0aFjM865EAAAAASUVORK5CYII="},330:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EHhEOMAQYhfYAAABcSURBVDjL1ZM7DoBACERn1rXxCN7/mCbPxsKChJVoslIBgRm+0i8FWCK/kyQyYNvOmAH2SzewVsoH6Dc7ZG0D5R6j7ZdnIkn9SXB1pUPg7Q2yeUC+v9gAdJv7u0+kGjIYZ1Y9RwAAAABJRU5ErkJggg=="},331:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.is_little_endian=a,t.get_model_arrayset_metadata=r,t.cast_array_buffer=s,t.get_model_array_attribute=function(t){var n=e.Deferred();void 0===t.metadata?(t.metadataSuccess=o,function(t,n){e.ajax({url:t.api_root+"models/"+t.mid+"/arraysets/"+t.aid+"/metadata?arrays="+t.array,contentType:"application/json",success:function(e){t.metadata=e.arrays[0],void 0!==t.metadataSuccess?t.metadataSuccess(t):t.success(t)},error:function(e,n,o){t.error&&t.error(e,n,o)},always:function(){n.resolve()}})}(t,n)):o(t);return n;function o(e){var t=[],o="",i=e.metadata,r=e.attribute,l="string"==i.attributes[r].type,c="&byteorder="+(a()?"little":"big");for(var d in l&&(c=""),i.dimensions)o="",o+=i.dimensions[d].begin,o+=":",o+=i.dimensions[d].end,t.push(o);t=t.join("|");var u=new XMLHttpRequest;u.open("GET",e.api_root+"models/"+e.mid+"/arraysets/"+e.aid+"/data?hyperchunks="+e.array+"/"+e.attribute+"/"+t+c),l||(u.responseType="arraybuffer"),u.success=e.success,u.attribute=e.attribute,u.metadata=i,u.isStringAttribute=l,u.onload=function(e){var t=this.response,o=this.metadata,i=this.metadata.attributes[this.attribute];if(1==o.dimensions.length)l=this.isStringAttribute?JSON.parse(this.responseText):s(t,i.type);else if(2==o.dimensions.length)for(var a=o.dimensions[0].end-o.dimensions[0].begin,r=o.dimensions[1].end-o.dimensions[1].begin,l=[],c=0;c!=a;++c)l.push(s(t,i.type,c*r,r));else window.alert("Can't handle array with "+o.dimensions.length+" dimensions.");this.success(l),n.resolve()},u.send()}},t.get_model_arrayset=function(e){void 0!==e.metadata?t(e):void 0!==n[e.api_root+e.mid+e.aid]?(e.metadata=n[e.api_root+e.mid+e.aid],t(e)):(e.metadataSuccess=t,r(e));function t(e){var t=e.metadata,n=[],o=[];if("arrays"in e){for(var i=parseInt(e.arrays.split(":")[0]);i!=parseInt(e.arrays.split(":")[1]);++i)n.push(i);for(var i=0;i!=n.length;++i)for(var r=n[i],l=0;l!=t[r].attributes.length;++l)o.push(r+"/"+l+"/...")}else o.push(".../.../...");var c=e.api_root+"models/"+e.mid+"/arraysets/"+e.aid+"/data?byteorder="+(a()?"little":"big")+"&hyperchunks="+encodeURIComponent(o.join(";")),d=new XMLHttpRequest;d.open("GET",c),d.responseType="arraybuffer",d.success=e.success,d.metadata=t,d.onload=function(t){var n,o,i,a,r,l=this.response,c=this.metadata,d=[],u=null,h=0,p=c.length;if(void 0!==e.arrays){var f=e.arrays.split(":");h=parseInt(f[0]),p=parseInt(f[1])}for(var g=0,m=h;m<p;m++){o=c[m],i=o.index,a=o.dimensions[0].end-o.dimensions[0].begin,r=o.attributes,(n={})["input-index"]=i;for(var v=0;v<r.length;v++)u=r[v],n[u.name]=s(l,u.type,g,a),g+=a;d.push(n)}this.success(d,c,e)},d.send()}};var n=t.arrayset_metadata_cache={},o=t.arrayset_metadata_retrieval_inprogress={},i=t.arrayset_metadata_callbacks={};function a(){return void 0===window.result&&(window.result=67305985===new Uint32Array(new Uint8Array([1,2,3,4]).buffer)[0]),window.result}function r(t){if(void 0!==n[t.api_root+t.mid+t.aid])t.metadata=n[t.api_root+t.mid+t.aid],void 0!==t.metadataSuccess?t.metadataSuccess(t):t.success(t);else if(o[t.api_root+t.mid+t.aid]){var a=void 0!==t.metadataSuccess?t.metadataSuccess:t.success;i[t.api_root+t.mid+t.aid].push({callback:a,parameters:t})}else{o[t.api_root+t.mid+t.aid]=!0;a=void 0!==t.metadataSuccess?t.metadataSuccess:t.success;void 0===i[t.api_root+t.mid+t.aid]&&(i[t.api_root+t.mid+t.aid]=[]),i[t.api_root+t.mid+t.aid].push({callback:a,parameters:t}),e.ajax({url:t.api_root+"models/"+t.mid+"/arraysets/"+t.aid+"/metadata",contentType:"application/json",success:function(e){n[t.api_root+t.mid+t.aid]=e,o[t.api_root+t.mid+t.aid]=!1;for(var a=0;a<i[t.api_root+t.mid+t.aid].length;a++){var r=i[t.api_root+t.mid+t.aid][a].parameters;r.metadata=e,i[t.api_root+t.mid+t.aid][a].callback(r)}},error:function(e,n,o){t.error&&t.error(e,n,o)}})}}function s(e,t,n,o){return"int32"==t?void 0!==n?new Int32Array(e,4*n,o):new Int32Array(e):"int16"==t?void 0!==n?new Int16Array(e,2*n,o):new Int16Array(e):"int8"==t?void 0!==n?new Int8Array(e,n,o):new Int8Array(e):"uint32"==t?void 0!==n?new Uint32Array(e,4*n,o):new Uint32Array(e):"uint16"==t?void 0!==n?new Uint16Array(e,2*n,o):new Uint16Array(e):"uint8"==t?void 0!==n?new Uint8Array(e,n,o):new Uint8Array(e):"float64"==t?void 0!==n?new Float64Array(e,8*n,o):new Float64Array(e):"float32"==t?void 0!==n?new Float32Array(e,4*n,o):new Float32Array(e):void console.error("Unknown array buffer type: "+t)}}).call(this,n(2))},332:function(e,t,n){"use strict";(function(e){var t=s(n(1)),o=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(n(6)),s(n(0))),i=s(n(3)),a=s(n(24)),r=s(n(333));function s(e){return e&&e.__esModule?e:{default:e}}o.default.components.register("slycat-job-checker",{viewModel:function(n){var r={_id:(0,a.default)(window.location).segment(-1)},s=this;s.remote=i.default.fromJS({hostname:null,username:null,password:null,status:null,status_type:null,enable:!0,focus:!1,sid:null,session_exists:!1}),s.remote.focus.extend({notify:"always"}),s.jid=o.default.observable(-1),s.output=o.default.observable("Output for the current job will be posted here...");var l=-1,c="";s.connect=function(){s.remote.enable(!1),s.remote.status_type("info"),s.remote.status("Connecting..."),s.remote.session_exists()?(s.remote.enable(!0),s.remote.status_type(null),s.remote.status(null),e("#slycat-job-checker-connect-modal").modal("hide"),e("#slycat-job-checker-cancel").removeAttr("disabled"),s.checkjob()):t.default.post_remotes({hostname:s.remote.hostname(),username:s.remote.username(),password:s.remote.password(),success:function(t){s.remote.session_exists(!0),s.remote.sid(t),s.remote.enable(!0),s.remote.status_type(null),s.remote.status(null),e("#slycat-job-checker-connect-modal").modal("hide"),e("#slycat-job-checker-cancel").removeAttr("disabled"),s.checkjob()},error:function(t,n,o){e("#slycat-job-checker-cancel").attr("disabled"),s.remote.enable(!0),s.remote.status_type("danger"),s.remote.status(o),s.remote.focus("password")}})},s.cancel=function(){s.remote.password(""),e("#slycat-job-checker-connect-modal").modal("hide"),s.output(s.output()+"\nPlease reload the page to check job "+s.jid()+"'s status.")},s.cancel_pull=function(){s.remote.password(""),console.log("cancel"),e("#slycat-pull-job-connect-modal").modal("hide"),s.output(s.output()+"\nPlease reload the page to check job "+s.jid()+"'s status.")};var d=function(e){t.default.get_checkjob({hostname:s.remote.hostname(),jid:s.jid(),success:function(e){if(e.errors)s.output(s.output()+"\n[Error] Could not check job iD="+s.jid()+" status: "+e.errors);else{var t=e.status.state;!function(e){return c===e}(t)?s.output(s.output()+"\nJob ID="+s.jid()+" is "+t):s.output(s.output()+"."),"COMPLETED"!==t&&"FAILED"!==t||(clearInterval(l),s.output(s.output()+"\n\nPlease reload to view model."),window.location.reload(!0),c=""),"CANCELLED"!==t&&"REMOVED"!==t||(clearInterval(l),c=""),c=t}},error:function(e,t,n){s.output(s.output()+"\n[Error] Could not check job status: "+t+" :"+n)}})};s.pullDataFromHpc=function(){console.log("1"),s.remote.enable(!1),s.remote.status_type("info"),s.remote.status("Connecting..."),s.remote.session_exists()?(console.log("got session"),s.remote.enable(!0),s.remote.status_type(null),s.remote.status(null),e("#slycat-pull-job-connect-modal").modal("hide"),s.pullHPCData()):t.default.post_remotes({hostname:s.remote.hostname(),username:s.remote.username(),password:s.remote.password(),success:function(t){s.remote.session_exists(!0),s.remote.sid(t),s.remote.enable(!0),s.remote.status_type(null),s.remote.status(null),e("#slycat-pull-job-connect-modal").modal("hide"),s.checkjob()},error:function(t,n,o){e("#slycat-job-checker-cancel").attr("disabled"),s.remote.enable(!0),s.remote.status_type("danger"),s.remote.status(o),s.remote.focus("password")}})},s.pullHPCData=function(){console.log("2"),t.default.get_model_command({mid:r._id,type:"timeseries",command:"pull_data",success:function(e){s.output(s.output()+"\nstarted pull status :"+e.errors)},error:function(e,t,n){s.output(s.output()+"\npull status: "+t+" :"+n)}})},s.checkjob=function(){c="",l=setInterval(d,1e3)},s.set_jid=function(e){s.jid(e)},e("#slycat-job-checker-connect").on("click",function(t){t.preventDefault(),t.stopPropagation(),e("#slycat-job-checker-connect-modal").modal()}),e("#slycat-job-pull").on("click",function(t){t.preventDefault(),t.stopPropagation(),e("#slycat-pull-job-connect-modal").modal()}),e("#slycat-job-checker-clear").on("click",function(e){e.preventDefault(),e.stopPropagation(),s.output("")}),e("#slycat-job-checker-cancel").on("click",function(e){e.preventDefault(),e.stopPropagation(),t.default.delete_job({hostname:s.remote.hostname(),jid:s.jid()})})},template:r.default})}).call(this,n(2))},333:function(e,t){e.exports='<div class="slycat-job-checker bootstrap-styles">\n  <div class="slycat-job-checker-controls">\n    <button id="slycat-job-checker-connect" class="btn btn-default">Connect To View Job Output</button>\n    <button id="slycat-job-checker-clear" class="btn btn-default">Clear Output</button>\n    <button id="slycat-job-pull" class="btn btn-default">Pull data</button>\n    <button id="slycat-job-checker-cancel" class="btn btn-danger" disabled>Cancel Job</button>\n  </div>\n  <div class="slycat-job-checker-output" data-bind="text: output"></div>\n\n  <div id="slycat-job-checker-connect-modal" class="modal fade" data-backdrop="static">\n    <div class="modal-dialog">\n      <div class="modal-content zoom-sensitive">\n        <div class="modal-header">\n          <h4 class="modal-title">Connect to host...</h4>\n        </div>\n        <div class="modal-body">\n          <form class="form-horizontal" role="form">\n            <slycat-remote-controls params="hostname:remote.hostname,username:remote.username,password:remote.password,status:remote.status,status_type:remote.status_type,enable:remote.enable,focus:remote.focus,activate:connect,session_exists:remote.session_exists"></slycat-remote-controls>\n          </form>\n        </div>\n        <div class="modal-footer">\n          <button class="btn btn-primary" data-bind="click:connect,enable:remote.enable">Connect</button>\n          <button class="btn btn-default pull-left" data-bind="click:cancel">Cancel</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div id="slycat-pull-job-connect-modal" class="modal fade" data-backdrop="static">\n    <div class="modal-dialog">\n      <div class="modal-content zoom-sensitive">\n        <div class="modal-header">\n          <h4 class="modal-title">Connect to host...</h4>\n        </div>\n        <div class="modal-body">\n          <form class="form-horizontal" role="form">\n            <slycat-remote-controls params="hostname:remote.hostname,username:remote.username,password:remote.password,status:remote.status,status_type:remote.status_type,enable:remote.enable,focus:remote.focus,activate:connect,session_exists:remote.session_exists"></slycat-remote-controls>\n          </form>\n        </div>\n        <div class="modal-footer">\n          <button class="btn btn-primary" data-bind="click:pullDataFromHpc,enable:remote.enable">Connect</button>\n          <button class="btn btn-default pull-left" data-bind="click:cancel_pull">Cancel</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n'},387:function(e,t,n){var o=n(388);"string"==typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,i);o.locals&&(e.exports=o.locals)},388:function(e,t,n){var o=n(37);(e.exports=n(35)(!1)).push([e.i,"/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n.ui-layout-resizer\n{\n  background-color: #ddc;\n}\n.ui-layout-toggler\n{\n  background-color: #ccb;\n}\n.ui-layout-resizer-open.ui-layout-resizer-hover, .ui-layout-resizer-dragging, .ui-layout-toggler-hover\n{\n  background-color: #fc6;\n}\n.ui-layout-pane, .ui-layout-container\n{\n  background: white;\n  padding: 0;\n  border: 0;\n  margin: 0;\n}\n\n#edit-model-button,\n#rerun-timeseries-button\n{\n  float: right;\n}\n\n/* cluster table styles */\n\n#cluster-pane\n{\n  z-index: 3 !important; /* Required to make bootstrap dropdowns appear over lower panes */\n}\n#controls {\n  margin: 2px 0px;\n}\n.center {\n  text-align: center;\n}\n\n#cluster-viewer\n{\n  margin: 5px;\n  border-collapse: collapse;\n}\n#cluster-viewer td,\n#cluster-viewer th\n{\n  padding: 3px;\n}\n#cluster-viewer td.output\n{\n  background: #dbd9eb;\n  cursor: pointer;\n}\n#cluster-viewer td.output.selected\n{\n  background: #7767b0;\n  color: white;\n}\n\n/* dendrogram styles */\n#dendrogram-pane #dendrogram-sort-control \n{\n  position: absolute;\n  bottom: 0px;\n  left: 0px;\n  cursor: pointer;\n  background: #DBD9EB url("+o(n(329))+") no-repeat center center;\n  padding: 4px;\n  margin: 0 0 5px 18px;\n  height: 17px;\n  min-width: 17px;\n}\n\n#dendrogram-pane #dendrogram-sort-control.selected\n{\n  background: #7767B0 url("+o(n(330))+") no-repeat center center;\n  color: #FFFFFF;\n  cursor: default;\n}\n\n#dendrogram-pane #dendrogram-controls \n{\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  margin: 5px 0 0px 18px;\n}\n\n#dendrogram-viewer .node .glyph circle\n{\n  stroke: grey;\n}\n\n#dendrogram-viewer .node.selected .glyph circle\n{\n  fill: #7767b0 !important;\n  stroke: black;\n}\n\n#dendrogram-viewer .node .glyph text\n{\n  cursor: pointer;\n}\n\n#dendrogram-viewer .node .subtree\n{\n  cursor: pointer;\n}\n\na \n{\n  cursor: pointer;\n}\n\n#dendrogram-viewer .node .subtree path\n{\n  stroke: none;\n}\n\n/* Hiding the additional glyph initially */\n#dendrogram-viewer .node .subtree path.filled-glyph\n{\n  display: none;\n}\n/* Showing it for selected nodes */\n#dendrogram-viewer .node.selected .subtree path.filled-glyph\n{\n  display: inline;\n}\n\n#dendrogram-viewer .node.selected .subtree text\n{\n  fill: white;\n}\n\n#dendrogram-viewer .node .sparkline path\n{\n  fill: none;\n  stroke: black;\n}\n\n#dendrogram-viewer .link\n{\n  fill: none;\n  stroke: #C9C9C9;\n}\n\n/* waveform styles */\n\n#waveform\n{\n  width: 1000px;\n  height: 700px;\n}\n\n/* data table styles */\n\n#data-pane\n{\n  overflow: auto;\n}\n\n/* Waveform Progress Indicator */\n#waveform-progress,\n#waveform-selection-progress\n{\n    background-color: transparent;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    width: 200px;\n    height: 200px;\n    margin: -100px 0 0 -100px;\n    display: none;\n}\n#waveform-selection-progress\n{\n  z-index: 1;\n}\n#waveform-selector-progress {\n  background-color: transparent;\n  position: absolute;\n  left: 0px;\n  top: 3px;\n  width: 100%;\n  height: 15px;\n  text-align: center;\n  display: none;\n}\n#waveform-selector-progress-wrapper {\n  display: none;\n}\n#waveform-pane:hover #waveform-selector-progress-wrapper {\n  display: block;\n}\n/* Use these colors for the dark night mode */\n#waveform-viewer.nightMode,\n.nightMode rect.selectionMask\n{\n  background-color: #333333;\n  fill: #333333;\n  fill-opacity: 0.5;\n}\n/* Use these colors for the white day mode */\n#waveform-viewer.dayMode,\n.dayMode rect.selectionMask\n{\n  background-color: white;\n  fill: white;\n  fill-opacity: 0.7;\n}\n\n#waveform-viewer .waveform path.unselected {\n  stroke-width: 1;\n  fill: none;\n  stroke-linecap: round;\n}\n#waveform-viewer .waveform path.unselected:hover {\n  stroke-width: 4;\n}\n#waveform-viewer .selection path.highlight {\n  stroke-width: 4.0;\n  fill: none;\n  stroke-linecap: round;\n}\n#table\n{\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n#dendrogram-sparkline-backdrop {\n  height: 100%;\n  width: 130px;\n  position: absolute;\n  right: 0;\n  z-index: -1;\n}\n#dendrogram-viewer g.sparkline path {\n  stroke-linecap: round;\n}\n#dendrogram-viewer g.sparkline path:hover,\n#dendrogram-viewer g.sparkline path.highlight\n{\n  stroke-width: 4px;\n}\n#dendrogram-viewer g.sparkline path.highlight {\n  \n}\n#dendrogram-viewer g.sparkline path.nullValue {\n  stroke-dasharray: 2px, 2px;\n}\n#dendrogram-viewer g.sparkline path.highlight.nullValue {\n  stroke-dasharray: 2px, 5px;\n}\n.legend-axis path,\n.legend-axis line,\n.x-axis path, \n.y-axis path\n{\n  fill: none;\n  stroke: black;\n  shape-rendering: crispedges;\n}\n\n#color-switcher ul.dropdown-menu\n{\n  background-color: #F2F2F2;\n}\n.bootstrap-styles #color-switcher .dropdown-menu > li > a:hover\n{\n  background-color: #E4E4E4;\n}\n.bootstrap-styles #color-switcher .dropdown-menu > .active > a:hover\n{\n  background-color: #337AB7;\n}\n#controls  ul.dropdown-menu  {\n  max-height: 300px;\n  overflow-y: auto;\n}\n",""])},389:function(e,t,n){"use strict";(function(e){n(279),e.widget("timeseries.cluster",{options:{clusters:[],cluster:0},_create:function(){var t=this;this.select_cluster=function(e){this.element.find("td.selected").removeClass("selected"),this.element.find("td:eq("+e+")").addClass("selected")};var n=this.options.clusters,o=(this.options.cluster,e("<tr>").appendTo(e("<thead>").appendTo(this.element)));e("<th>").text("Outputs:").appendTo(o),e.each(n,function(n,i){e("<td>").addClass("output").appendTo(o).data("name",i).data("self",t).data("index",n).text(i).click(function(e,n){return function(){e.select_cluster(n),t.options.cluster=n,e.element.trigger("cluster-changed",n)}}(t,n))}),this.select_cluster(this.options.cluster)}})}).call(this,n(2))},390:function(e,t,n){"use strict";(function(e){var t=c(n(302)),o=c(n(327)),i=c(n(62)),a=c(n(18)),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(6)),s=c(n(46)),l=c(n(328));function c(e){return e&&e.__esModule?e:{default:e}}n(279),n(253),e.widget("timeseries.controls",{options:{mid:null,model_name:null,aid:null,metadata:null,"color-variable":null,clusters:[],cluster:null,color_variables:[],selection:[],hidden_simulations:[],indices:[],highlight:[]},_create:function(){var t=this,n=e("#general-controls",this.element);this.color_control=e('<div class="btn-group btn-group-xs"></div>').appendTo(n),this.color_button=e('      <button class="btn btn-default dropdown-toggle" type="button" id="color-dropdown" data-toggle="dropdown" aria-expanded="true" title="Change Line Color">         Line Color         <span class="caret"></span>       </button>       ').appendTo(t.color_control),this.color_items=e('<ul id="y-axis-switcher" class="dropdown-menu" role="menu" aria-labelledby="color-dropdown">').appendTo(t.color_control),this.csv_button=e("      <button class='btn btn-default' title='Download Data Table'>         <span class='fa fa-download' aria-hidden='true'></span>       </button>       ").click(function(){0!=t.options.highlight.length||null!=t.options.selection&&t.options.selection.length!=t.options.metadata["row-count"]?function(){var e,n="",o=[{className:"btn-default",label:"Cancel"},{className:"btn-primary",label:"Save Entire Table",icon_class:"fa fa-table"}];e=null!=t.options.selection&&t.options.selection.length>0?t.options.highlight.filter(function(e){return-1!=t.options.selection.indexOf(e)}):t.options.highlight;e.length>0&&(n+="You have "+e.length+" rows selected. ",o.splice(o.length-1,0,{className:"btn-primary",label:"Save Selected",icon_class:"fa fa-check"}));if(null!=t.options.selection&&t.options.selection.length>0&&t.options.selection.length<t.options.metadata["row-count"]){var i=t.options.selection.length;n+="You have "+i+" rows visible. ",o.splice(o.length-1,0,{className:"btn-primary",label:"Save Visible",icon_class:"fa fa-eye"})}n+="What would you like to do?",r.dialog({title:"Download Choices",message:n,buttons:o,callback:function(n){"Save Entire Table"==n.label?t._write_data_table():"Save Selected"==n.label?t._write_data_table(e):"Save Visible"==n.label&&t._write_data_table(t.options.selection)}})}():t._write_data_table()}).appendTo(n),t._set_color_variables()},_write_data_table:function(t){var n=this;e.ajax({type:"POST",url:a.default+"models/"+n.options.mid+"/arraysets/"+n.options.aid+"/data",data:(0,i.default)({hyperchunks:"0/.../..."}),contentType:"application/json",success:function(e){n._write_csv(n._convert_to_csv(e,t),n.options.model_name+"_data_table.csv")},error:function(e,t,n){window.alert("Error retrieving data table: "+n)}})},_write_csv:function(e,t){var n=new Blob([e],{type:"application/csv;charset=utf-8;"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.style="visibility:hidden",i.download=t||"slycatDataTable.csv",document.body.appendChild(i),i.click(),document.body.removeChild(i)},_convert_to_csv:function(e,t){var n=s.default.zip.apply(s.default,(0,o.default)(e));void 0!=t&&t.length>0&&(t.sort(),n=s.default.at(n,t));var i=this.options.metadata["column-names"].slice(0,-1);return n.unshift(i),l.default.unparse(n)},_set_color_variables:function(){var n=this;this.color_items.empty();var o=!0,i=!1,a=void 0;try{for(var r,s=(0,t.default)(this.options.color_variables);!(o=(r=s.next()).done);o=!0){var l=r.value;e("<li role='presentation'>").toggleClass("active",n.options["color-variable"]==l).attr("data-colorvariable",l).appendTo(n.color_items).append(e('<a role="menuitem" tabindex="-1">').html(this.options.metadata["column-names"][l]).click(function(){var t=e(this).parent();if(t.hasClass("active"))return!1;n.color_items.find("li").removeClass("active"),t.addClass("active"),n.element.trigger("color-selection-changed",t.attr("data-colorvariable"))}))}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}},_set_selected_color:function(){this.color_items.find("li").removeClass("active"),this.color_items.find('li[data-colorvariable="'+this.options["color-variable"]+'"]').addClass("active")},_cloneArrayBuffer:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},_setOption:function(e,t){this.options[e]=t,"color-variable"==e?this._set_selected_color():"color_variables"==e&&this._set_color_variables()}})}).call(this,n(2))},391:function(e,t,n){"use strict";(function(e){var t=function(e){return e&&e.__esModule?e:{default:e}}(n(280));e.widget("timeseries.legend",{options:{width:300,height:300,metadata:null,label:"Label",min:null,max:null,border:25,v_type:null,uniqueValues:null},_create:function(){this.svg=t.default.select(this.element.get(0)).append("svg"),this.legend_layer=this.svg.append("g").attr("class","legend"),this.legend_axis_layer=this.legend_layer.append("g").attr("class","legend-axis"),this.updates={},this.update_timer=null,this._schedule_update({update_width:!0,update_height:!0,render_legend:!0,update_legend_colors:!0,update_legend_position:!0,update_legend_axis:!0,update_label:!0})},_setOption:function(e,t){this.options[e]=t,"v"==e?this._schedule_update({update_color_domain:!0,render_data:!0,render_selection:!0,update_legend_axis:!0}):"width"==e?this._schedule_update({update_width:!0}):"height"==e?this._schedule_update({update_height:!0,update_legend_position:!0,update_legend_axis:!0,update_label:!0}):"gradient"==e?this._schedule_update({update_legend_colors:!0}):"min"==e||"max"==e?this._schedule_update({update_legend_axis:!0}):"label"==e&&this._schedule_update({update_label:!0})},_schedule_update:function(e){var t=this;for(var n in e)t.updates[n]=e[n];t.update_timer||(t.update_timer=window.setTimeout(function(){t._update()},0))},_update:function(){if(this.update_timer=null,this.updates.update_width&&(this.element.attr("width",this.options.width),this.svg.attr("width",this.options.width)),this.updates.update_height&&(this.element.attr("height",this.options.height),this.svg.attr("height",this.options.height)),this.updates.render_legend){this.legend_layer.append("defs").append("linearGradient").attr("id","color-gradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");this.legend_layer.append("rect").classed("color",!0).attr("width",10).attr("height",200).attr("x",0).attr("y",0).style("fill","url(#color-gradient)")}if(this.updates.update_legend_colors){var e=this.legend_layer.select("#color-gradient").selectAll("stop").data(this.options.gradient);e.exit().remove(),e.enter().append("stop"),e.attr("offset",function(e){return e.offset+"%"}).attr("stop-color",function(e){return e.color})}if(this.updates.update_legend_position){this.element.width();var n=this.element.height(),o=parseInt(n-2*this.options.border),i=this.options.border+28,a=this.options.border;this.legend_layer.attr("transform","translate("+i+","+a+")").attr("data-transx",i).attr("data-transy",a),this.legend_layer.select("rect.color").attr("height",o)}if(this.updates.update_legend_axis){"string"!=this.options.v_type?this.legend_scale=t.default.scale.linear().domain([this.options.max,this.options.min]).range([0,parseInt(this.legend_layer.select("rect.color").attr("height"))]):this.legend_scale=t.default.scale.ordinal().domain(this.options.uniqueValues.reverse()).rangePoints([0,parseInt(this.legend_layer.select("rect.color").attr("height"))]),this.legend_axis=t.default.svg.axis().scale(this.legend_scale).orient("right"),this.legend_axis_layer.attr("transform","translate("+parseInt(this.legend_layer.select("rect.color").attr("width"))+",0)").call(this.legend_axis);this.legend_layer.select("rect.color").style("fill","url(#color-gradient)")}if(this.updates.update_label){this.legend_layer.selectAll(".label").remove();var r=(o=parseInt(this.legend_layer.select("rect.color").attr("height")))/2;this.legend_layer.append("text").attr("class","label").attr("x",-15).attr("y",r).attr("transform","rotate(-90,-15,"+r+")").style("text-anchor","middle").style("font-weight","bold").text(this.options.label)}this.updates={}}})}).call(this,n(2))},392:function(e,t,n){"use strict";(function(e){var t=function(e){return e&&e.__esModule?e:{default:e}}(n(280));n(291),n(292),n(293),n(294),n(295),n(296);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(331));e.widget("timeseries.table",{options:{api_root:"",mid:null,aid:null,metadata:null,"row-selection":[],"variable-selection":[],"sort-variable":null,"sort-order":null,colormap:null,colorscale:null,table_filter:[],waveform_indexes:[],selection:null,row_count:null,image_columns:[]},_create:function(){var e,n,o=this;function i(e){return null==e?"&nbsp;":(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(e,n,o,a,r){return a.colorscale?"<div class='highlightWrapper"+(null==o?" null":"")+(t.default.hcl(a.colorscale(o)).l>50?" light":" dark")+"' style='background:"+a.colorscale(o)+"'>"+i(o)+"</div>":null==o?"<div class='highlightWrapper"+(null==o?" null":"")+"'>"+i(o)+"</div>":i(o)}function r(e,t,n){var i={id:e,field:e,name:o.options.metadata["column-names"][e],sortable:!1,headerCssClass:t,cssClass:n,formatter:a,header:{buttons:[{cssClass:o.options["sort-variable"]==e?"ascending"==o.options["sort-order"]?"icon-sort-ascending":"icon-sort-descending":"icon-sort-off",tooltip:o.options["sort-variable"]==e&&"ascending"==o.options["sort-order"]?"Sort descending":"Sort ascending",command:o.options["sort-variable"]==e&&"ascending"==o.options["sort-order"]?"sort-descending":"sort-ascending"}]}};return o.options.image_columns.indexOf(e)>-1&&(i.headerCssClass+=" headerImage"),i}o.columns=[],o.columns.push(r(o.options.metadata["column-count"]-1,"headerSimId","rowSimId"));for(var s=0;s<o.options.metadata["column-count"]-1;s++)e="headerInput",n="rowInput",o.options.image_columns.indexOf(s)>-1&&(e="headerOther",n="rowOther"),o.columns.push(r(s,e,n))},resize_canvas:function(){this.grid.resizeCanvas()},_setOption:function(n,i){function a(e,t){r.options["sort-variable"]=e,r.options["sort-order"]=t,r.data.set_sort(e,t,function(){if(r.options["row-selection"].length>0){var e=r.data.getSimulationRowIndexes(r.options["row-selection"]);r.trigger_row_selection=!1,r.grid.setSelectedRows(e),r.grid.resetActiveCell(),e.length&&r.grid.scrollRowToTop(Math.min.apply(Math,e))}}),r.element.trigger("variable-sort-changed",[e,t])}var r=this;if("row-selection"==n){r.options[n]=i;var s=r.data.getSimulationRowIndexes(r.options["row-selection"]);r.trigger_row_selection=!1,r.grid.setSelectedRows(s),r.grid.resetActiveCell(),s.length&&r.grid.scrollRowToTop(Math.min.apply(Math,s))}else if("row-selection-silent"==n)r.options["row-selection"]=i;else if("variable-selection"==n){if(r._array_equal(r.options[n],i))return;r.options[n]=i,r._color_variables(i)}else if("colorscale"==n)r.options[n]=i,r._color_variables(r.options["variable-selection"]);else if("selection"==n){var l,c,d=function(e){var t=void 0,n=void 0;if(void 0!==e){var o;if("descending"==r.options["sort-order"]){for(var i=[],s=0;s<e.length;s++)i.push(e[s]);e=i.reverse()}var l=[];for(s=0;s<r.options.table_filter.length;s++)l.push(e.indexOf(r.options.table_filter[s]));n=(t=(o=new Int32Array(l)).length>1?Array.apply([],o):[o[0]]).slice(0).sort(function(e,t){return e-t})}if(r.data=new r._data_provider({api_root:r.options.api_root,mid:r.options.mid,aid:r.options.aid,metadata:r.options.metadata,sort_column:r.options["sort-variable"],sort_order:r.options["sort-order"],table_filter:r.options.table_filter,row_count:r.options.row_count,sorted_table_filter:t,retrieve_table_filter:n}),r.grid){if(r.grid.setData(r.data),r.data.setGrid(r.grid),r.grid.invalidate(),r.options["row-selection"].length>0){var c=r.data.getSimulationRowIndexes(r.options["row-selection"]);r.trigger_row_selection=!1,r.grid.setSelectedRows(c),r.grid.resetActiveCell(),c.length&&r.grid.scrollRowToTop(Math.min.apply(Math,c))}}else{r.trigger_row_selection=!0,r.grid=new Slick.Grid(r.element,r.data,r.columns,{explicitInitialization:!0,enableColumnReorder:!1}),r.data.setGrid(r.grid);var d=new Slick.Plugins.HeaderButtons;if(d.onCommand.subscribe(function(e,t){var n=t.column,o=t.button,i=t.command,s=t.grid;for(var l in r.columns)r.columns[l].header.buttons[0].cssClass="icon-sort-off",r.columns[l].header.buttons[0].tooltip="Sort ascending",r.columns[l].header.buttons[0].command="sort-ascending",s.updateColumnHeader(r.columns[l].id);"sort-ascending"==i?(o.cssClass="icon-sort-ascending",o.command="sort-descending",o.tooltip="Sort descending",a(n.id,"ascending")):"sort-descending"==i&&(o.cssClass="icon-sort-descending",o.command="sort-ascending",o.tooltip="Sort ascending",a(n.id,"descending"))}),r.grid.registerPlugin(d),r.grid.registerPlugin(new Slick.AutoTooltips({enableForHeaderCells:!0})),r.grid.setSelectionModel(new Slick.RowSelectionModel),r.grid.onSelectedRowsChanged.subscribe(function(e,t){if(r.trigger_row_selection){for(var n=[],o=0;o<t.rows.length;o++)n.push(r.grid.getDataItem(t.rows[o])[r.options.metadata["column-count"]-1]);r.options["row-selection"]=n,r.element.trigger("row-selection-changed",[n])}r.trigger_row_selection=!0}),r.grid.onHeaderClick.subscribe(function(e,t){r._array_equal([t.column.field],r.options["variable-selection"])||-1!=r.options.image_columns.indexOf(t.column.field)||(r.options["variable-selection"]=[t.column.field],r.element.trigger("variable-selection-changed",{variable:r.options["variable-selection"],colorscale:t.column.colorscale}))}),r._color_variables(r.options["variable-selection"]),r.grid.init(),r.options["row-selection"].length>0){c=r.data.getSimulationRowIndexes(r.options["row-selection"]);r.trigger_row_selection=!1,r.grid.setSelectedRows(c),r.grid.resetActiveCell(),c.length&&r.grid.scrollRowToTop(Math.min.apply(Math,c))}}r.data.onDataLoaded.subscribe(function(e,t){for(var n=t.from;n<=t.to;n++)r.grid.invalidateRow(n);r.grid.render()})};r.options[n]=i;var u=[],h=[];if(e.each(i,function(e,t){l=t["data-table-index"],c=t["waveform-index"],null!=l&&(u.push(l),h.push(c))}),r.options.table_filter=u,r.options.waveform_indexes=h,r.options.row_count=u.length,null!==r.options["sort-variable"]&&null!==r.options["sort-order"]&&r.options.table_filter.length>0)if(r.options["sort-variable"]==r.options.metadata["column-count"]-1)d(new Int32Array(t.default.range(r.options.metadata["row-count"])));else{var p=new XMLHttpRequest;p.open("GET",r.options.api_root+"models/"+r.options.mid+"/arraysets/"+r.options.aid+"/data?hyperchunks=0/rank(a"+r.options["sort-variable"]+',"asc")/...&byteorder='+(o.is_little_endian()?"little":"big")),p.responseType="arraybuffer",p.onload=function(e){for(var t=[],n=new Int32Array(this.response),o=0;o<n.length;o+=2)t.push(n[o]);t=new Int32Array(t),d(t)},p.send()}else d()}else if("sort-variable"==n)for(var f in r.options[n]=i,null===i&&(r.options["sort-order"]=null),a(r.options["sort-variable"],r.options["sort-order"]),r.columns)r.columns[f].header.buttons[0].cssClass="icon-sort-off",r.columns[f].header.buttons[0].tooltip="Sort ascending",r.columns[f].header.buttons[0].command="sort-ascending",r.grid.updateColumnHeader(r.columns[f].id)},_color_variables:function(t){var n=this.grid.getColumns();for(var o in n){var i=n[o];null!==this.options.colorscale&&-1!=e.inArray(i.id,t)?(i.colorscale=this.options.colorscale,i.cssClass=i.cssClass.split(" ")[0]+" highlight"):(i.colorscale=null,i.cssClass=i.cssClass.split(" ")[0])}this.grid.invalidate()},_data_provider:function(n){var i=this;i.api_root=n.api_root,i.mid=n.mid,i.aid=n.aid,i.metadata=n.metadata,i.sort_column=n.sort_column,i.sort_order=n.sort_order,i.table_filter=n.table_filter,void 0==n.sorted_table_filter?i.sorted_table_filter=n.table_filter:i.sorted_table_filter=n.sorted_table_filter,void 0==n.retrieve_table_filter?i.retrieve_table_filter=n.table_filter:i.retrieve_table_filter=n.retrieve_table_filter,i.row_count=n.row_count,i.ranked_indices={},i.pages={},i.pages_in_progress={},i.page_size=50,i.onDataLoaded=new Slick.Event,i.get_indices_old=function(t,n,a,r){if(0!=r&&(r=!0),0!=n.length){var s="";null!==i.sort_column&&null!==i.sort_order&&(s="&sort="+i.sort_column+":"+i.sort_order);for(var l="",c=0;c<n.length;++c){l+=n[c];break}for(c=1;c<n.length;++c)l+=",",l+=n[c];if(r){var d=new XMLHttpRequest;d.open("GET",i.api_root+"models/"+i.mid+"/tables/"+i.aid+"/arrays/0/"+t+"-indices?rows="+l+"&index=Index&byteorder="+(o.is_little_endian()?"little":"big")+s),d.responseType="arraybuffer",d.callback=a,d.onload=function(e){this.callback(new Int32Array(this.response))},d.send()}else e.ajax({type:"GET",url:i.api_root+"models/"+i.mid+"/tables/"+i.aid+"/arrays/0/"+t+"-indices?rows="+l+"&index=Index"+s,async:!1,callback:a,success:function(e){this.callback(new Int32Array(e))}})}else a([])},i.get_indices=function(e,n,a){if(0!=n.length)if(null==i.sort_column||null==i.sort_order)a(n);else if(i.ranked_indices[i.sort_column]){var r=i.ranked_indices[i.sort_column];if("descending"==i.sort_order){for(var s=[],l=0;l<r.length;l++)s.push(r[l]);r=s.reverse()}var c=[];for(l=0;l<n.length;l++)"unsorted"==e?c.push(r[n[l]]):"sorted"==e&&c.push(r.indexOf(n[l]));a(new Int32Array(c))}else if(i.sort_column==i.metadata["column-count"]-1)i.ranked_indices[i.sort_column]=new Int32Array(t.default.range(i.metadata["row-count"])),i.get_indices(e,n,a);else{var d=new XMLHttpRequest;d.open("GET",i.api_root+"models/"+i.mid+"/arraysets/"+i.aid+"/data?hyperchunks=0/rank(a"+i.sort_column+',"asc")/...&byteorder='+(o.is_little_endian()?"little":"big")),d.responseType="arraybuffer",d.direction=e,d.rows=n,d.callback=a,d.onload=function(e){for(var t=[],n=new Int32Array(this.response),o=0;o<n.length;o+=2)t.push(n[o]);i.ranked_indices[i.sort_column]=new Int32Array(t),i.get_indices(this.direction,this.rows,this.callback)},d.send()}else a([])},i.setGrid=function(e){i.grid=e},i.getLength=function(){return i.row_count},i.getItem_old=function(t){var n=i.metadata["column-count"],o=Math.floor(t/i.page_size),a=o*i.page_size;if(!(o in i.pages)){var r=a,s=(o+1)*i.page_size,l="";null!==i.sort_column&&null!==i.sort_order&&(l="&sort="+i.sort_column+":"+i.sort_order);var c=i.retrieve_table_filter.slice(r,s).join(",");e.ajax({type:"GET",url:i.api_root+"models/"+i.mid+"/tables/"+i.aid+"/arrays/0/chunk?rows="+c+"&columns=0-"+n+"&index=Index"+l,async:!1,success:function(e){i.pages[o]=e},error:function(e,t,n){console.log("error",e,t,n)}})}for(var d={},u=0;u!=n;++u)d[u]=i.pages[o].data[u][t-a];return d},i.getItem=function(t){var n=i.metadata["column-count"],o=Math.floor(t/i.page_size),a=o*i.page_size;if(i.pages_in_progress[o])return null;if(!(o in i.pages)){i.pages_in_progress[o]=!0;var r=a,s=(o+1)*i.page_size,l=i.retrieve_table_filter.slice(r,s).join("|"),c="";if(null!==i.sort_column&&null!==i.sort_order){var d="a"+i.sort_column,u=i.sort_order;"ascending"==u?u="asc":"descending"==u&&(u="desc"),i.sort_column==i.metadata["column-count"]-1&&(d="index(0)"),c="/order: rank("+d+', "'+u+'")'}return e.ajax({type:"GET",url:i.api_root+"models/"+i.mid+"/arraysets/"+i.aid+"/data?hyperchunks=0/0:"+(n-1)+"|index(0)"+c+"/"+l,success:function(e){i.pages[o]=[];for(var t=n-0,a=e.length/t,l=0;l<a;l++){for(var c={},d=0;d!=n;++d)c[d]=e[(d-0)*a+l];i.pages[o].push(c)}i.pages_in_progress[o]=!1,i.onDataLoaded.notify({from:r,to:s})},error:function(e,t,n){console.log("error",e,t,n)}}),null}return i.pages[o][t-a]},i.getItemMetadata=function(e){return null},i.set_sort=function(e,t,n){e==i.sort_column&&t==i.sort_order||(null==e||null==t?(i.sort_column=e,i.sort_order=t,i.sorted_table_filter=i.table_filter,i.retrieve_table_filter=i.table_filter,i.pages={},i.grid.invalidate(),n()):(i.sort_column=e,i.sort_order=t,i.get_indices("sorted",i.table_filter,function(e){e.length>1?i.sorted_table_filter=Array.apply([],e):i.sorted_table_filter=[e[0]],i.retrieve_table_filter=i.sorted_table_filter.slice(0).sort(function(e,t){return e-t}),i.pages={},i.grid.invalidate(),n()})))},i.getSimulationRowIndexes=function(e){for(var t,n,o,a=[],r=0;r<e.length;r++)(t=i.table_filter.indexOf(e[r]))>-1&&(n=i.sorted_table_filter[t],o=i.retrieve_table_filter.indexOf(n),a.push(o));return a}},_array_equal:function(t,n){return 0==e(t).not(n).length&&0==e(n).not(t).length}})}).call(this,n(2))},393:function(e,t,n){"use strict";(function(e){var t=function(e){return e&&e.__esModule?e:{default:e}}(n(280)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(331));n(253),e.widget("timeseries.dendrogram",{options:{api_root:"",mid:null,clusters:[],cluster:0,cluster_data:null,collapsed_nodes:null,expanded_nodes:null,selected_nodes:null,color_array:null,color_scale:null,data_table_index_array:null,dendrogram_sort_order:!0,highlight:[],image_columns:[]},_create:function(){this._set_cluster()},_set_cluster:function(){var n=this;n.container=t.default.select("#dendrogram-viewer");for(var i=this.options.cluster_data,a=this.options.collapsed_nodes,r=this.options.expanded_nodes,s=this.options.selected_nodes,l=(n.options.api_root,n.options.mid,i.linkage),c=i["input-indices"],d=i.exemplars,u=[],h=0;h<c.length;h++)u.push({"node-index":u.length,leaves:1,exemplar:d[h],selected:!1,"waveform-index":h,"data-table-index":c[h]});for(h=0;h<l.length;h++)u.push({"node-index":u.length,children:[u[l[h][0]],u[l[h][1]]],leaves:l[h][3],exemplar:d[h+c.length],selected:!1,"waveform-index":null,"data-table-index":null});var p=this.element.parent().width()-20-20-110,f=this.element.parent().height()-20-20,g=t.default.layout.cluster().size([f,p]).separation(function(){return 1});n.container.selectAll("g").remove(),n.sortControl=e('<div id="dendrogram-sort-control"></div>').appendTo("#dendrogram-pane").click(function(){e(this).hasClass("selected")||(n.options.dendrogram_sort_order=!0,n._set_dendrogram_sort_order_state(),n.element.trigger("sort-by-dendrogram-order"))}),n.outputsButtonLabel=e("#dendrogram-controls button.outputs .buttonLabel"),n.outputs_items=e("#dendrogram-controls ul.outputs"),n._set_dendrogram_sort_order_state(),n._set_outputs();var m=n.container.append("svg:g").attr("transform","translate(20,20)"),v=u[u.length-1];n.root=v,v.x0=f/2,v.y0=0;var _=g.nodes(v).reverse(),b=-1;if(_.forEach(function(e){b=Math.max(b,e.depth)}),null==a&&null==r&&null==s||_.forEach(function(e){null!=s&&s.length>0&&s.indexOf(e["node-index"])>-1&&(e.selected=!0),a&&a.indexOf(e["node-index"])>-1&&e.children?T(e):r&&r.indexOf(e["node-index"])>-1&&e._children&&T(e)}),null==r&&null==a&&_.forEach(function(e){3==e.depth&&T(e)}),null==s)A(n,v,!0);else{C(),S();var w=[];k(v,w),n.element.trigger("node-selection-changed",{node:null,skip_bookmarking:!0,selection:w})}function y(e){for(var t=[],n=null,o=0;o<e.length;o++)null!=(n=e[o]["node-index"])&&t.push(n);return t}function x(e,t){return e.target._children?"M"+e.source.y+","+e.source.x+"V"+e.target.x+"H"+p:"M"+e.source.y+","+e.source.x+"V"+e.target.x+"H"+e.target.y}function k(e,t){if(e.selected&&t.push({"node-index":e["node-index"],"waveform-index":e["waveform-index"],"data-table-index":e["data-table-index"]}),e.children)for(var n=0;n<e.children.length;n++)k(e.children[n],t);if(e._children)for(n=0;n<e._children.length;n++)k(e._children[n],t)}function A(e,t,n){!function e(t){if(t.selected=!0,t.children)for(var n=0;n<t.children.length;n++)e(t.children[n]);if(t._children)for(n=0;n<t._children.length;n++)e(t._children[n])}(t),C(),S();var o=[];k(v,o),e.options.selected_nodes=y(o),e.element.trigger("node-selection-changed",{node:t,skip_bookmarking:n,selection:o})}function C(){n.container.selectAll(".node").classed("selected",function(e){return e.selected})}function S(){n.container.selectAll("path.link").attr("style",function(e){if(function e(t){if(t.selected)return!0;if(t.children){for(var n=0;n<t.children.length;n++)if(e(t.children[n]))return!0}else if(t._children)for(var n=0;n<t._children.length;n++)if(e(t._children[n]))return!0;return!1}(e.target))return e.source.selected?"stroke: black;":"stroke: #646464;"})}function T(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),n.element.trigger("node-toggled",e)}!function i(a,r){var s=t.default.event&&t.default.event.altKey?5e3:500;var l=g.nodes(v).reverse();var c=-1;l.forEach(function(e){c=Math.max(c,e.children?e.depth:-1)});l.forEach(function(e){(e.children||e._children)&&(e.y=e.depth*(p/(c+1)))});var d=m.selectAll("g.node").data(l,function(e){return e["node-index"]});function h(e,t){if(e.children)for(var n=0;n<e.children.length;n++)e.children[n].depth==t&&e.children[n].children?T(e.children[n]):e.children[n].depth<t&&e.children[n]._children?(T(e.children[n]),h(e.children[n],t)):e.children[n].depth<t&&e.children[n].children&&h(e.children[n],t)}var f=d.enter().append("svg:g").attr("class","node").classed("selected",function(e){return e.selected}).attr("transform",function(e){return"translate("+a.y0+","+a.x0+")"}).style("opacity",1e-6);var _=f.append("svg:g").attr("class","subtree").style("opacity",1e-6).style("display",function(e){return e.leaves>1?"inline":"none"}).on("click",function(e){T(e);h(e,e.depth+9999),i(e)});_.append("svg:path").attr("class","subtree-glyph").attr("title","Expand all").attr("alt","Expand all").attr("d","M 0 0 L 40 -13 L 40 13 Z").style("fill","url(#subtree-gradient)");_.append("svg:path").attr("class","filled-glyph").attr("title","Expand all").attr("alt","Expand all").attr("d","M 0 0 L 40 -13 L 40 13 Z").style("fill","#7767b0");_.append("svg:text").attr("x",28).attr("dy",".4em").attr("text-anchor","middle").attr("title","Expand all").attr("alt","Expand all").text(function(e){return e.leaves});_.append("svg:text").attr("x",-9).attr("dy",-5).attr("text-anchor","middle").text("+").style("fill","black").on("click",function(e){T(e);h(e,e.depth+2),i(e),t.default.event.stopPropagation()});var b=f.append("svg:g").attr("class","glyph").on("click",function(o){t.default.event.ctrlKey||t.default.event.metaKey?o.selected?function(t,n,o){(function e(t){t.selected=!1;if(t.children)for(var n=0;n<t.children.length;n++)e(t.children[n]);if(t._children)for(var n=0;n<t._children.length;n++)e(t._children[n])})(n),function t(n){if(n.children||n._children){if(n.selected){var o=!1,i=!1;return n.children&&e.each(n.children,function(e,n){i=t(n),o=o||i}),n._children&&e.each(n._children,function(e,n){i=t(n),o=o||i}),n.selected=o,o}return n.children&&e.each(n.children,function(e,n){t(n)}),n._children&&e.each(n._children,function(e,n){t(n)}),!1}return!!n.selected}(v),C(),S();var i=[];k(v,i),t.options.selected_nodes=y(i),t.element.trigger("node-selection-changed",{node:n,skip_bookmarking:o,selection:i})}(n,o):A(n,o):(e.each(u,function(e,t){t.selected=!1}),A(n,o))});b.append("svg:circle").attr("r",4.5).style("cursor","pointer").style("fill",function(e){return e.children||e._children?"#dbd9eb":"white"});b.append("svg:text").attr("x",-9).attr("dy",13).attr("text-anchor","middle").text("").style("fill","black").style("display",function(e){return e._children||!e.children&&!e._children?"none":"inline"}).on("click",function(e){T(e),i(e),t.default.event.stopPropagation()});var w=f.append("svg:g").attr("class","sparkline").attr("transform",function(e){return e.leaves>1?"translate(55, 0)":"translate(15, 0)"}).style("opacity",1e-6).style("display","none");var P=w.append("svg:path").style("stroke",function(t,o){if(null!==n.options.color_scale&&null!=n.options.color_array){var i=t["data-table-index"];if(null!=i){var a=n.options.color_array[i];return null!=a?n.options.color_scale(a):e("#color-switcher").colorswitcher("get_null_color")}return"black"}return"black"}).classed("nullValue",function(e,t){return!(null==e["data-table-index"]||null!=e["data-table-index"]&&null!==n.options.color_array[e["data-table-index"]])}).on("click",function(e){n._handle_highlight(e,t.default.event,this)});n._set_highlight();function I(e){return Array.isArray(e)?e:JSON.parse(e)}o.get_model_arrayset_metadata({api_root:n.options.api_root,mid:n.options.mid,aid:"preview-"+I(n.options.clusters)[n.options.cluster],success:function(i){P.each(function(i,a){void 0==i.exemplar?e(this).attr("d",""):o.get_model_arrayset({api_root:n.options.api_root,mid:n.options.mid,aid:"preview-"+I(n.options.clusters)[n.options.cluster],arrays:i.exemplar+":"+(i.exemplar+1),element:this,success:function(n,o,i){for(var a=n[0].value,r=[],s=0;s!=a.length;++s)r.push(a[s]);var l=t.default.min(r),c=t.default.max(r),d=t.default.scale.linear().domain([0,r.length-1]).range([0,100]),u=t.default.scale.linear().domain([c,l]).range([-15,15]).nice(),h=t.default.svg.line().x(function(e,t){return d(t)}).y(function(e){return u(e)});e(i.element).attr("d",h(r))}})})}});var j=d.transition().duration(s).attr("transform",function(e){return"translate("+(e._children?p-40:e.y)+","+e.x+")"}).style("opacity",1);j.select(".subtree").style("opacity",function(e){return e._children?1:1e-6}).style("display",function(e){return e._children?"inline":"none"});j.select(".subtree-glyph").style("fill","url(#subtree-gradient)");j.select(".sparkline").style("opacity",function(e){return e._children||!e.children&&!e._children?1:1e-6}).each("end",function(){t.default.select(this).style("display",function(e){return e._children||!e.children&&!e._children?"inline":"none"})});j.select(".glyph text").style("display",function(e){return e._children||!e.children&&!e._children?"none":"inline"});var E=d.exit().transition().duration(s).attr("transform",function(e){return"translate("+a.y+","+a.x+")"}).style("opacity",1e-6).remove();E.select(".sparkline").each("start",function(){t.default.select(this).style("display","none")});var O=m.selectAll("path.link").data(g.links(l),function(e){return e.target["node-index"]});O.enter().insert("svg:path","g").attr("class","link").attr("d",function(e){var t={x:a.x0,y:a.y0};return x({source:t,target:t})}).transition().duration(s).attr("d",x);O.transition().duration(s).attr("d",x);O.exit().transition().duration(s).attr("d",function(e){var t={x:a.x,y:a.y};return x({source:t,target:t})}).remove();S();l.forEach(function(e){e.x0=e.x,e.y0=e.y});if(!r){var M=[],$=[];!function e(t){if(t.children){M.push(t["node-index"]);for(var n=0;n<t.children.length;n++)e(t.children[n])}else t._children&&$.push(t["node-index"])}(v),n.options.expanded_nodes=M,n.options.collapsed_nodes=$,n.element.trigger("expanded-collapsed-nodes-changed",{expanded:M,collapsed:$})}}(v,!0)},_set_color:function(){var t=this;this.container.selectAll("g.sparkline path").style("stroke",function(n,o){var i=n["data-table-index"];if(null!=i){var a=t.options.color_array[i];return null!=a?t.options.color_scale(a):e("#color-switcher").colorswitcher("get_null_color")}return"black"}).classed("nullValue",function(e,n){return null!=e["data-table-index"]&&(null==e["data-table-index"]||null===t.options.color_array[e["data-table-index"]])})},_set_highlight:function(){var e=this;!function t(n){var o=!1;if(n.children){for(var i=0;i<n.children.length;i++)t(n.children[i])&&(o=!0);n.highlight=o}else if(n._children){for(var i=0;i<n._children.length;i++)t(n._children[i])&&(o=!0);n.highlight=o}else null!=n["data-table-index"]&&e.options.highlight.indexOf(n["data-table-index"])>-1?(n.highlight=!0,o=!0):(n.highlight=!1,o=!1);return o}(e.root),this.container.selectAll("g.sparkline path").classed("highlight",function(e,t){return!!e.highlight})},_handle_highlight:function(e,t,n){var o=function e(t){var n=[];if(t.children)for(var o=0;o<t.children.length;o++)null!=t.children[o]["data-table-index"]?n.push(t.children[o]["data-table-index"]):n=n.concat(e(t.children[o]));else if(t._children)for(var o=0;o<t._children.length;o++)null!=t._children[o]["data-table-index"]?n.push(t._children[o]["data-table-index"]):n=n.concat(e(t._children[o]));else null!=t["data-table-index"]&&n.push(t["data-table-index"]);return n}(e);if(t.ctrlKey||t.metaKey)if(e.highlight)for(var i=0;i<o.length;i++){var a=this.options.highlight.indexOf(o[i]);a>-1&&this.options.highlight.splice(a,1)}else for(i=0;i<o.length;i++)-1==this.options.highlight.indexOf(o[i])&&this.options.highlight.push(o[i]);else this.options.highlight=o;this._set_highlight(),this.element.trigger("waveform-selection-changed",[this.options.highlight])},_set_dendrogram_sort_order_state:function(){var e=this;e.sortControl.attr("title",function(t,n){return e.options.dendrogram_sort_order?"Inputs are sorted in dendrogram order":"Sort inputs in dendrogram order"}).toggleClass("selected",e.options.dendrogram_sort_order)},_set_outputs:function(){var t=this;t.outputs_items.empty();for(var n=0;n<t.options.clusters.length;n++)e("<li role='presentation'>").toggleClass("active",t.options.cluster==n).attr("data-cluster",n).appendTo(t.outputs_items).append(e('<a role="menuitem" tabindex="-1">').html(t.options.clusters[n]).click(function(){var n=e(this).parent();if(n.hasClass("active"))return!1;t.outputs_items.find("li").removeClass("active"),n.addClass("active"),t.options.cluster=n.attr("data-cluster"),t.element.trigger("cluster-changed",n.attr("data-cluster"))}));t.outputsButtonLabel.text(t.options.clusters[t.options.cluster])},resize_canvas:function(){this._set_cluster()},_setOption:function(e,t){this.options[e]=t,"cluster_data"==e?this._set_cluster():"color-options"==e?(this.options.color_array=t.color_array,this.options.color_scale=t.color_scale,this._set_color()):"color_scale"==e?this._set_color():"dendrogram_sort_order"==e?this._set_dendrogram_sort_order_state():"highlight"==e&&(void 0==t&&(this.options.highlight=[]),this._set_highlight())}})}).call(this,n(2))},394:function(e,t,n){"use strict";(function(e){var t=o(n(280));o(n(395));function o(e){return e&&e.__esModule?e:{default:e}}e.widget("timeseries.waveformplot",{options:{mid:null,waveforms:null,selection:null,highlight:[],color_array:null,color_scale:null,nullWaveformColor:"gray",nullWaveformDasharray:"5,5",hover:[]},_create:function(){var n=this;this.waveforms=this.options.waveforms,this.container=t.default.select("#waveform-viewer"),this.width=e("#waveform-pane").width(),this.height=e("#waveform-pane").height(),this.padding_top=20,this.padding_right=20,this.padding_bottom=40,this.padding_left=60,this.diagram_width=this.width-this.padding_right-this.padding_left,this.diagram_height=this.height-this.padding_top-this.padding_bottom,this.waveformPieContainer=e("#waveform-progress"),this.waveformPie=e("#waveform-progress .waveformPie"),this.waveformPie.knob({min:0,readOnly:!0,displayInput:!1,fgColor:"#7767B0",bgColor:"#DBD9EB",width:200,height:200,thickness:.35,step:1}),this.waveformSelectionPieContainer=e("#waveform-selection-progress"),this.waveformSelectionPie=e("#waveform-selection-progress .waveformPie"),this.waveformSelectionPie.knob({min:0,readOnly:!0,displayInput:!1,fgColor:"#7767B0",bgColor:"#DBD9EB",width:200,height:200,thickness:.35,step:1}),this.waveformSelectorPieContainer=e("#waveform-selector-progress"),this.waveformSelectorPie=e("#waveform-selector-progress .waveformPie"),this.waveformSelectorPie.knob({min:0,readOnly:!0,displayInput:!1,fgColor:"#7767B0",bgColor:"#DBD9EB",width:15,height:15,thickness:.5,step:1}),this.waveformProcessingTimeout={timeoutID:null},this.waveformSelectionProcessingTimeout={timeoutID:null},this.previewWaveformsTimeout=null,this.showWaveformPieContainerTimeout=null,this.showWaveformSelectionPieContainerTimeout=null,this.showWaveformSelectorPieContainerTimeout=null,this.color_array=this.options.color_array,this.color_scale=this.options.color_scale,this.container.selectAll("canvas").remove(),this.x_axis_layer=this.container.append("g").attr("class","x-axis"),this.y_axis_layer=this.container.append("g").attr("class","y-axis"),this.canvas_datum=t.default.select(n.element.parent().get(0)).insert("canvas",":first-child").style({position:"absolute",left:this.padding_left+"px",top:this.padding_top+"px"}).node(),this.canvas_datum_ctx=this.canvas_datum.getContext("2d",{alpha:!0}),this.canvas_selection=t.default.select(n.element.parent().get(0)).append("canvas").style({position:"absolute",left:this.padding_left+"px",top:this.padding_top+"px"}).node(),this.canvas_selection_ctx=this.canvas_selection.getContext("2d",{alpha:!0}),this.canvas_hover=t.default.select(n.element.parent().get(0)).append("canvas").style({position:"absolute",left:this.padding_left+"px",top:this.padding_top+"px"}).node(),this.canvas_hover_ctx=this.canvas_hover.getContext("2d",{alpha:!0}),this.canvas_offscreen=document.createElement("canvas"),this.canvas_offscreen_ctx=this.canvas_offscreen.getContext("2d",{alpha:!0}),this.canvas_picker=document.createElement("canvas"),this.canvas_picker_ctx=this.canvas_picker.getContext("2d",{alpha:!0}),this.canvas_hover.addEventListener("mousemove",function(e){var t,o,i=e.layerX,a=e.layerY,r=n.canvas_picker_ctx.getImageData(i,a,1,1).data;r[0],r[1],r[2],r[3],255==r[3]?(t=function(e,t,n){return e<<16|t<<8|n}(r[0],r[1],r[2]),o=n.paths[t],n.canvas_picker_ctx.isPointInStroke(o,i,a)&&(n.options.hover=[t],n._hover())):n.options.hover.length>0&&(n.options.hover=[],n._hover())}),this.canvas_hover.addEventListener("click",function(e){if(e.ctrlKey||e.metaKey){var t=n.options.highlight.indexOf(n.options.hover[0]);t<0?n.options.highlight.push(n.options.hover[0]):(n.options.highlight.splice(t,1),n.options.hover=[],n._hover())}else n.options.highlight=n.options.hover.slice();n._selection(),n.element.trigger("waveform-selection-changed",[n.options.highlight]),e.stopPropagation()});var o=this.options.selection;if(null===o){o=[];for(var i=0;i<this.waveforms.length;i++)o.push(this.waveforms[i]["input-index"]);this.options.selection=o}this._set_visible(),this._selection()},_calculate_paths:function(){var e,n,o,i=t.default.min(this.waveforms,function(e){return t.default.min(e.time)}),a=t.default.max(this.waveforms,function(e){return t.default.max(e.time)}),r=t.default.min(this.waveforms,function(e){return t.default.min(e.value)}),s=t.default.max(this.waveforms,function(e){return t.default.max(e.value)});this.x=t.default.scale.linear().domain([i,a]).range([0,this.diagram_width]),this.y=t.default.scale.linear().domain([s,r]).range([0,this.diagram_height]),this.paths=[];for(var l=0;l<this.waveforms.length;l++){o=new Path2D,n=(e=this.waveforms[l]).time.length;for(var c=0;c!=n;++c){o.moveTo(this.x(e.time[c]),this.y(e.value[c]));break}for(c=1;c<n;++c)o.lineTo(this.x(e.time[c]),this.y(e.value[c]));this.paths[e["input-index"]]=o}},_set_visible:function(){var n=this,o=this.options.selection;this.waveforms=this.options.waveforms,n._stopProcessingWaveforms();var i=t.default.min(this.waveforms,function(e){return t.default.min(e.time)}),a=t.default.max(this.waveforms,function(e){return t.default.max(e.time)}),r=t.default.min(this.waveforms,function(e){return t.default.min(e.value)}),s=t.default.max(this.waveforms,function(e){return t.default.max(e.value)});this.x=t.default.scale.linear().domain([i,a]).range([0,this.diagram_width]),this.y=t.default.scale.linear().domain([s,r]).range([0,this.diagram_height]),this.x_axis=t.default.svg.axis().scale(this.x).orient("bottom"),this.x_axis_layer.attr("transform","translate("+(this.padding_left-1)+","+(this.padding_top+this.diagram_height+1)+")").call(this.x_axis),this.y_axis=t.default.svg.axis().scale(this.y).orient("left"),this.y_axis_layer.attr("transform","translate("+(this.padding_left-1)+","+(this.padding_top+1)+")").call(this.y_axis),t.default.selectAll("canvas").attr("width",this.diagram_width).attr("height",this.diagram_height),this.canvas_offscreen.width=this.diagram_width,this.canvas_offscreen.height=this.diagram_height,this.canvas_picker.width=this.diagram_width,this.canvas_picker.height=this.diagram_height;var l=e("#color-switcher").colorswitcher("get_background"),c=e("#color-switcher").colorswitcher("get_opacity");this.canvas_hover_ctx.fillStyle="rgba("+l.r+", "+l.g+", "+l.b+", "+c+")",this.canvas_selection_ctx.fillStyle="rgba("+l.r+", "+l.g+", "+l.b+", "+c+")";var d=[];if(void 0!==o)for(var u=0;u<o.length;u++)d.push(n.waveforms[o[u]]);else d=n.waveforms;this.canvas_offscreen_ctx.lineWidth=1,this.canvas_picker_ctx.lineWidth=3,this.canvas_hover_ctx.lineWidth=3,this.canvas_selection_ctx.lineWidth=3;var h=null!=n.options.color_scale&&null!=n.options.color_array;function p(e){n.canvas_picker_ctx.strokeStyle=function(e){var n=e>>16&255,o=e>>8&255,i=255&e;return t.default.rgb(n,o,i)}(e["input-index"]),n.canvas_picker_ctx.stroke(n.paths[e["input-index"]])}function f(){clearTimeout(n.showWaveformSelectorPieContainerTimeout),n.waveformSelectorPieContainer.hide()}this.waveformsLength=d.length,this.waveformsLength>0&&(n.waveformPie.trigger("configure",{max:this.waveformsLength}),n.waveformSelectorPie.trigger("configure",{max:this.waveformsLength}),n.showWaveformPieContainerTimeout=setTimeout(function(){n.waveformPieContainer.show(0)},1e3),this._calculate_paths(),n._timedProcessArray(d,function(t){var o=h&&null!==n.options.color_array[t["input-index"]];if(o)var i=n.options.color_scale(n.options.color_array[t["input-index"]]);else{var i=e("#color-switcher").colorswitcher("get_null_color");n.canvas_offscreen_ctx.setLineDash([8,4])}n.canvas_offscreen_ctx.strokeStyle=i,n.canvas_offscreen_ctx.stroke(n.paths[t["input-index"]]),o||n.canvas_offscreen_ctx.setLineDash([])},function(){clearTimeout(n.showWaveformPieContainerTimeout),n.waveformPieContainer.hide(),clearTimeout(n.previewWaveformsTimeout),n.previewWaveformsTimeout=void 0,n.canvas_datum_ctx.drawImage(n.canvas_offscreen,0,0),n.showWaveformSelectorPieContainerTimeout=setTimeout(function(){n.waveformSelectorPieContainer.show(0)},1e3),n._timedProcessArray(d,p,f,n.waveformSelectorPie,n.waveformProcessingTimeout)},n.waveformPie,n.waveformProcessingTimeout),function(e,t,o){null==o&&(o=500);n.previewWaveformsTimeout=setTimeout(function i(){t.drawImage(e,0,0),n.previewWaveformsTimeout&&(n.previewWaveformsTimeout=setTimeout(i,o))},o)}(n.canvas_offscreen,n.canvas_datum_ctx))},_hover:function(t){for(var n=this.options.selection,o=this.options.hover,i=[],a=0;a<o.length;a++)n.indexOf(o[a])>-1&&i.push(o[a]);o=i;var r=[];for(a=0;a<o.length;a++){var s=o[a];s<this.waveforms.length&&r.push(this.waveforms[s])}this.canvas_hover_ctx.clearRect(0,0,this.canvas_hover.width,this.canvas_hover.height),r.length>0&&this.canvas_hover_ctx.fillRect(0,0,this.canvas_hover.width,this.canvas_hover.height);var l,c,d=null!=this.options.color_scale&&null!=this.options.color_array;for(a=0;a<r.length;a++){if(l=r[a]["input-index"],c=d&&null!==this.options.color_array[l])var u=this.options.color_scale(this.options.color_array[l]);else{u=e("#color-switcher").colorswitcher("get_null_color");this.canvas_hover_ctx.setLineDash([8,4])}this.canvas_hover_ctx.strokeStyle=u,this.canvas_hover_ctx.stroke(this.paths[l]),c||this.canvas_hover_ctx.setLineDash([])}},_selection:function(t){var n=this;n._stopProcessingWaveformsSelection();for(var o=n.options.selection,i=n.options.highlight,a=[],r=0;r<i.length;r++)o.indexOf(i[r])>-1&&a.push(i[r]);i=a;var s=[];for(r=0;r<i.length;r++){var l=i[r];l<n.waveforms.length&&s.push(n.waveforms[l])}n.canvas_selection_ctx.clearRect(0,0,n.canvas_selection.width,n.canvas_selection.height),s.length>0&&(n.canvas_selection_ctx.fillRect(0,0,n.canvas_hover.width,n.canvas_hover.height),n.waveformSelectionPie.trigger("configure",{max:s.length}),n.showWaveformSelectionPieContainerTimeout=setTimeout(function(){n.waveformSelectionPieContainer.show(0)},1e3),n._timedProcessArray(s,function(t){var o=c&&null!==n.options.color_array[t["input-index"]];if(o)var i=n.options.color_scale(n.options.color_array[t["input-index"]]);else{var i=e("#color-switcher").colorswitcher("get_null_color");n.canvas_selection_ctx.setLineDash([8,4])}n.canvas_selection_ctx.strokeStyle=i,n.canvas_selection_ctx.stroke(n.paths[t["input-index"]]),o||n.canvas_selection_ctx.setLineDash([])},function(){clearTimeout(n.showWaveformSelectionPieContainerTimeout),n.waveformSelectionPieContainer.hide()},n.waveformSelectionPie,n.waveformSelectionProcessingTimeout));var c=null!=n.options.color_scale&&null!=n.options.color_array},_stopProcessingWaveforms:function(){clearTimeout(this.waveformProcessingTimeout.timeoutID),clearTimeout(this.previewWaveformsTimeout),this.previewWaveformsTimeout=void 0,clearTimeout(this.showWaveformPieContainerTimeout),this.waveformPieContainer.hide()},_stopProcessingWaveformsSelection:function(){clearTimeout(this.waveformSelectionProcessingTimeout.timeoutID),clearTimeout(this.showWaveformSelectionPieContainerTimeout),this.waveformSelectionPieContainer.hide()},_timedProcessArray:function(e,t,n,o,i){var a=e.concat();i.timeoutID=setTimeout(function r(){var s=+new Date;do{t(a.shift())}while(a.length>0&&+new Date-s<50);a.length>0?i.timeoutID=setTimeout(r,100):n(e),o.val(e.length-a.length).trigger("change")},100)},resize_canvas:function(){this.width=e("#waveform-pane").width(),this.height=e("#waveform-pane").height(),this.diagram_width=this.width-this.padding_left-this.padding_right,this.diagram_height=this.height-this.padding_top-this.padding_bottom,this._set_visible(),this._selection()},_setOption:function(e,t){if(this.options[e]=t,"selection"==e)this._set_visible();else if("highlight"==e)this._selection();else if("color-options"==e)this.options.color_array=t.color_array,this.options.color_scale=t.color_scale,this._set_visible(),this._selection();else if("color_scale"==e)this._set_visible(),this._selection();else if("waveforms"==e){if(this.container.selectAll("g.waveform").remove(),this.container.selectAll("g.selection").remove(),this.container.selectAll("rect.selectionMask").remove(),this.options.waveforms=t.waveforms,null===t.selection){visible=[];for(var n=0;n<this.options.waveforms.length;n++)visible.push(this.options.waveforms[n]["input-index"]);this.options.selection=visible}else this.options.selection=t.selection;void 0!==t.highlight&&(this.options.highlight=t.highlight),this._set_visible(),this._selection()}}})}).call(this,n(2))},395:function(e,t,n){var o,i,a;i=[n(2)],void 0===(a="function"==typeof(o=function(e){"use strict";var t={},n=Math.max,o=Math.min;t.c={},t.c.d=e(document),t.c.t=function(e){return e.originalEvent.touches.length-1},t.o=function(){var n=this;this.o=null,this.$=null,this.i=null,this.g=null,this.v=null,this.cv=null,this.x=0,this.y=0,this.w=0,this.h=0,this.$c=null,this.c=null,this.t=0,this.isInit=!1,this.fgColor=null,this.pColor=null,this.dH=null,this.cH=null,this.eH=null,this.rH=null,this.scale=1,this.relative=!1,this.relativeWidth=!1,this.relativeHeight=!1,this.$div=null,this.run=function(){var t=function(e,t){var o;for(o in t)n.o[o]=t[o];n._carve().init(),n._configure()._draw()};if(!this.$.data("kontroled")){if(this.$.data("kontroled",!0),this.extend(),this.o=e.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:(!0===this.$.data("cursor")?30:this.$.data("cursor"))||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(e){return e},parse:function(e){return parseFloat(e)}},this.o),this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation,this.o.inputColor||(this.o.inputColor=this.o.fgColor),this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(t){var o=e(this);n.i[t]=o,n.v[t]=n.o.parse(o.val()),o.bind("change blur",function(){var e={};e[t]=o.val(),n.val(n._validate(e))})}),this.$.find("legend").remove()):(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){n.val(n._validate(n.o.parse(n.$.val())))})),!this.o.displayInput&&this.$.hide(),this.$c=e(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height}),this.$div=e('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>'),this.$.wrap(this.$div).before(this.$c),this.$div=this.$.parent(),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]),this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null,!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};return this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1),this.relativeWidth=this.o.width%1!=0&&this.o.width.indexOf("%"),this.relativeHeight=this.o.height%1!=0&&this.o.height.indexOf("%"),this.relative=this.relativeWidth||this.relativeHeight,this._carve(),this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v,this.$.bind("configure",t).parent().bind("configure",t),this._listen()._configure()._xy().init(),this.isInit=!0,this.$.val(this.o.format(this.v)),this._draw(),this}},this._carve=function(){if(this.relative){var e=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),t=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(e,t)}else this.w=this.o.width,this.h=this.o.height;return this.$div.css({width:this.w+"px",height:this.h+"px"}),this.$c.attr({width:this.w,height:this.h}),1!==this.scale&&(this.$c[0].width=this.$c[0].width*this.scale,this.$c[0].height=this.$c[0].height*this.scale,this.$c.width(this.w),this.$c.height(this.h)),this},this._draw=function(){var e=!0;n.g=n.c,n.clear(),n.dH&&(e=n.dH()),!1!==e&&n.draw()},this._touch=function(e){var o=function(e){var t=n.xy2val(e.originalEvent.touches[n.t].pageX,e.originalEvent.touches[n.t].pageY);t!=n.cv&&(n.cH&&!1===n.cH(t)||(n.change(n._validate(t)),n._draw()))};return this.t=t.c.t(e),o(e),t.c.d.bind("touchmove.k",o).bind("touchend.k",function(){t.c.d.unbind("touchmove.k touchend.k"),n.val(n.cv)}),this},this._mouse=function(e){var o=function(e){var t=n.xy2val(e.pageX,e.pageY);t!=n.cv&&(n.cH&&!1===n.cH(t)||(n.change(n._validate(t)),n._draw()))};return o(e),t.c.d.bind("mousemove.k",o).bind("keyup.k",function(e){if(27===e.keyCode){if(t.c.d.unbind("mouseup.k mousemove.k keyup.k"),n.eH&&!1===n.eH())return;n.cancel()}}).bind("mouseup.k",function(e){t.c.d.unbind("mousemove.k mouseup.k keyup.k"),n.val(n.cv)}),this},this._xy=function(){var e=this.$c.offset();return this.x=e.left,this.y=e.top,this},this._listen=function(){return this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(e){e.preventDefault(),n._xy()._mouse(e)}).bind("touchstart",function(e){e.preventDefault(),n._xy()._touch(e)}),this.listen()),this.relative&&e(window).resize(function(){n._carve().init(),n._draw()}),this},this._configure=function(){return this.o.draw&&(this.dH=this.o.draw),this.o.change&&(this.cH=this.o.change),this.o.cancel&&(this.eH=this.o.cancel),this.o.release&&(this.rH=this.o.release),this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor,this},this._clear=function(){this.$c[0].width=this.$c[0].width},this._validate=function(e){var t=~~((e<0?-.5:.5)+e/this.o.step)*this.o.step;return Math.round(100*t)/100},this.listen=function(){},this.extend=function(){},this.init=function(){},this.change=function(e){},this.val=function(e){},this.xy2val=function(e,t){},this.draw=function(){},this.clear=function(){this._clear()},this.h2rgba=function(e,t){var n;return e=e.substring(1,7),"rgba("+(n=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)])[0]+","+n[1]+","+n[2]+","+t+")"},this.copy=function(e,t){for(var n in e)t[n]=e[n]}},t.Dial=function(){t.o.call(this),this.startAngle=null,this.xy=null,this.radius=null,this.lineWidth=null,this.cursorExt=null,this.w2=null,this.PI2=2*Math.PI,this.extend=function(){this.o=e.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)},this.val=function(e,t){if(null==e)return this.v;e=this.o.parse(e),!1!==t&&e!=this.v&&this.rH&&!1===this.rH(e)||(this.cv=this.o.stopper?n(o(e,this.o.max),this.o.min):e,this.v=this.cv,this.$.val(this.o.format(this.v)),this._draw())},this.xy2val=function(e,t){var i,a;return i=Math.atan2(e-(this.x+this.w2),-(t-this.y-this.w2))-this.angleOffset,this.o.flip&&(i=this.angleArc-i-this.PI2),this.angleArc!=this.PI2&&i<0&&i>-.5?i=0:i<0&&(i+=this.PI2),a=i*(this.o.max-this.o.min)/this.angleArc+this.o.min,this.o.stopper&&(a=n(o(a,this.o.max),this.o.min)),a},this.listen=function(){var t,i,a,r,s=this,l=function(e){e.preventDefault();var a=e.originalEvent,r=a.detail||a.wheelDeltaX,l=a.detail||a.wheelDeltaY,c=s._validate(s.o.parse(s.$.val()))+(r>0||l>0?s.o.step:r<0||l<0?-s.o.step:0);c=n(o(c,s.o.max),s.o.min),s.val(c,!1),s.rH&&(clearTimeout(t),t=setTimeout(function(){s.rH(c),t=null},100),i||(i=setTimeout(function(){t&&s.rH(c),i=null},200)))},c=1,d={37:-s.o.step,38:s.o.step,39:s.o.step,40:-s.o.step};this.$.bind("keydown",function(t){var i=t.keyCode;if(i>=96&&i<=105&&(i=t.keyCode=i-48),a=parseInt(String.fromCharCode(i)),isNaN(a)&&(13!==i&&8!==i&&9!==i&&189!==i&&(190!==i||s.$.val().match(/\./))&&t.preventDefault(),e.inArray(i,[37,38,39,40])>-1)){t.preventDefault();var l=s.o.parse(s.$.val())+d[i]*c;s.o.stopper&&(l=n(o(l,s.o.max),s.o.min)),s.change(s._validate(l)),s._draw(),r=window.setTimeout(function(){c*=2},30)}}).bind("keyup",function(e){isNaN(a)?r&&(window.clearTimeout(r),r=null,c=1,s.val(s.$.val())):s.$.val()>s.o.max&&s.$.val(s.o.max)||s.$.val()<s.o.min&&s.$.val(s.o.min)}),this.$c.bind("mousewheel DOMMouseScroll",l),this.$.bind("mousewheel DOMMouseScroll",l)},this.init=function(){(this.v<this.o.min||this.v>this.o.max)&&(this.v=this.o.min),this.$.val(this.v),this.w2=this.w/2,this.cursorExt=this.o.cursor/100,this.xy=this.w2*this.scale,this.lineWidth=this.xy*this.o.thickness,this.lineCap=this.o.lineCap,this.radius=this.xy-this.lineWidth/2,this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset),this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc),this.angleOffset=this.o.angleOffset*Math.PI/180,this.angleArc=this.o.angleArc*Math.PI/180,this.startAngle=1.5*Math.PI+this.angleOffset,this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=n(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/e>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})},this.change=function(e){this.cv=e,this.$.val(this.o.format(e))},this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min)},this.arc=function(e){var t,n;return e=this.angle(e),this.o.flip?(t=this.endAngle+1e-5,n=t-e-1e-5):(t=this.startAngle-1e-5,n=t+e+1e-5),this.o.cursor&&(t=n-this.cursorExt)&&(n+=this.cursorExt),{s:t,e:n,d:this.o.flip&&!this.o.cursor}},this.draw=function(){var e,t=this.g,n=this.arc(this.cv),o=1;t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,"none"!==this.o.bgColor&&(t.beginPath(),t.strokeStyle=this.o.bgColor,t.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,!0),t.stroke()),this.o.displayPrevious&&(e=this.arc(this.v),t.beginPath(),t.strokeStyle=this.pColor,t.arc(this.xy,this.xy,this.radius,e.s,e.e,e.d),t.stroke(),o=this.cv==this.v),t.beginPath(),t.strokeStyle=o?this.o.fgColor:this.fgColor,t.arc(this.xy,this.xy,this.radius,n.s,n.e,n.d),t.stroke()},this.cancel=function(){this.val(this.v)}},e.fn.dial=e.fn.knob=function(n){return this.each(function(){var o=new t.Dial;o.o=n,o.$=e(this),o.run()}).parent()}})?o.apply(t,i):o)||(e.exports=a)},396:function(e,t,n){"use strict";(function(e){var t=function(e){return e&&e.__esModule?e:{default:e}}(n(280));n(279),e.widget("slycat.colorswitcher",{options:{colormap:"day"},_create:function(){var n=this;this.color_maps={night:{label:"Night",background:t.default.rgb(128,128,128),null_color:"rgb(75,75,75)",opacity:"0.5",colors:[t.default.rgb(59,76,192),t.default.rgb(68,90,204),t.default.rgb(77,104,215),t.default.rgb(87,117,225),t.default.rgb(98,130,234),t.default.rgb(108,142,241),t.default.rgb(119,154,247),t.default.rgb(130,165,251),t.default.rgb(141,176,254),t.default.rgb(152,185,255),t.default.rgb(163,194,255),t.default.rgb(174,201,253),t.default.rgb(184,208,249),t.default.rgb(194,213,244),t.default.rgb(204,217,238),t.default.rgb(213,219,230),t.default.rgb(221,221,221),t.default.rgb(229,216,209),t.default.rgb(236,211,197),t.default.rgb(241,204,185),t.default.rgb(245,196,173),t.default.rgb(247,187,160),t.default.rgb(247,177,148),t.default.rgb(247,166,135),t.default.rgb(244,154,123),t.default.rgb(241,141,111),t.default.rgb(236,127,99),t.default.rgb(229,112,88),t.default.rgb(222,96,77),t.default.rgb(213,80,66),t.default.rgb(203,62,56),t.default.rgb(192,40,47),t.default.rgb(180,4,38)]},day:{label:"Day",background:t.default.rgb(255,255,255),null_color:"gray",opacity:"0.7",colors:[t.default.rgb(100,108,234),t.default.rgb(115,118,240),t.default.rgb(128,128,244),t.default.rgb(140,138,248),t.default.rgb(151,147,250),t.default.rgb(161,155,251),t.default.rgb(169,163,251),t.default.rgb(177,170,250),t.default.rgb(184,177,248),t.default.rgb(189,182,245),t.default.rgb(193,187,241),t.default.rgb(197,191,236),t.default.rgb(199,194,230),t.default.rgb(200,196,224),t.default.rgb(201,198,216),t.default.rgb(200,199,208),t.default.rgb(198,198,198),t.default.rgb(210,197,195),t.default.rgb(220,194,192),t.default.rgb(229,191,187),t.default.rgb(236,186,181),t.default.rgb(243,181,175),t.default.rgb(248,175,168),t.default.rgb(251,168,160),t.default.rgb(254,159,152),t.default.rgb(255,150,143),t.default.rgb(255,140,133),t.default.rgb(253,129,123),t.default.rgb(250,117,112),t.default.rgb(246,105,101),t.default.rgb(240,91,90),t.default.rgb(233,75,78),t.default.rgb(225,57,66)]},rainbow:{label:"Rainbow Night",background:t.default.rgb(128,128,128),null_color:"rgb(75,75,75)",opacity:"0.6",colors:[t.default.rgb(0,0,255),t.default.rgb(0,255,255),t.default.rgb(255,255,0),t.default.rgb(255,0,0)]},rainbow_day:{label:"Rainbow Day",background:t.default.rgb(255,255,255),null_color:"gray",opacity:"0.7",colors:[t.default.rgb(0,0,255),t.default.rgb(0,255,255),t.default.rgb(255,255,0),t.default.rgb(255,0,0)]}},this.button=e('<button class="btn btn-xs btn-default dropdown-toggle" type="button" id="colors-dropdown" data-toggle="dropdown" aria-expanded="true" title="Line Color Theme">           Colors           <span class="caret"></span>         </button>').appendTo(this.element),this.list=e('<ul class="dropdown-menu" role="menu" aria-labelledby="colors-dropdown">').appendTo(this.element),e.each(this.color_maps,function(t,o){for(var i=n.get_gradient_data(t),a=[],r=0;r<i.length;r++)a.push(i[r].color+" "+i[r].offset+"%");var s=n.get_background(t);e('<li role="presentation">').addClass("color").toggleClass("active",t==n.options.colormap).attr("data-colormap",t).appendTo(n.list).append(e('<a role="menuitem" tabindex="-1">').html(o.label).click(function(){var t=e(this).parent();if(t.hasClass("active"))return!1;n.options.colormap=t.attr("data-colormap"),n.list.find(".color").removeClass("active"),t.addClass("active"),n.element.trigger("colormap-changed",[n.options.colormap])}).css({"background-image":"linear-gradient(to bottom, "+a.join(", ")+"), linear-gradient(to bottom, "+s+", "+s+")","background-size":"5px 75%, 50px 100%","background-position":"right 10px center, right 5px center","background-repeat":"no-repeat, no-repeat","padding-right":"70px"}))})},_setOption:function(e,t){this.options[e]=t,"colormap"==e&&(this.list.find(".color").removeClass("active"),this.list.find("[data-colormap='"+this.options.colormap+"']").addClass("active"))},get_background:function(e){return void 0===e&&(e=this.options.colormap),this.color_maps[e].background},get_null_color:function(e){return void 0===e&&(e=this.options.colormap),this.color_maps[e].null_color},get_opacity:function(e){return void 0===e&&(e=this.options.colormap),this.color_maps[e].opacity},get_color_scale:function(e,n,o){void 0===e&&(e=this.options.colormap),void 0===n&&(n=0),void 0===o&&(o=1);var i=[],a=t.default.scale.linear().domain([0,this.color_maps[e].colors.length-1]).range([n,o]);for(var r in this.color_maps[e].colors)i.push(a(r));return t.default.scale.linear().domain(i).range(this.color_maps[e].colors)},get_color_map:function(e,t,n){return this.get_color_scale(e,t,n)},get_color_scale_ordinal:function(e,n){void 0===e&&(e=this.options.colormap),void 0===n&&(n=[0,1]);for(var o=t.default.scale.ordinal().domain(n).rangePoints([0,100],0),i=this.get_color_scale(e,0,100),a=[],r=0;r<n.length;r++)a.push(i(o(n[r])));return t.default.scale.ordinal().domain(n).range(a)},get_color_map_ordinal:function(e,t){return this.get_color_scale_ordinal(e,t)},get_gradient_data:function(e){void 0===e&&(e=this.options.colormap);for(var t=this.color_maps[e].colors,n=t.length,o=[],i=0;i<n;i++)o.push({offset:i*(100/(n-1)),color:t[n-1-i]});return o},setUpColorMapsForAllColumns:function(e,t){for(var n=0;n!=t.length;++n)t[n].colorMap=this.get_color_scale(e,t[n].columnMin,t[n].columnMax)}})}).call(this,n(2))}}]);
//# sourceMappingURL=ui_timeseries_module.js.map